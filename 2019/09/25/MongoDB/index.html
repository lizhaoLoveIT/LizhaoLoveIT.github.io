<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>MongoDB | Ammar's Blog</title><meta name="description" content="MongoDB"><meta name="keywords" content="数据库"><meta name="author" content="Ammar"><meta name="copyright" content="Ammar"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.1/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="http://lizhaoloveit.cn/2019/09/25/MongoDB/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="MongoDB"><meta name="twitter:description" content="MongoDB"><meta name="twitter:image" content="https://lizhaoloveit.cn/blogimages/blog/avatar.jpg"><meta property="og:type" content="article"><meta property="og:title" content="MongoDB"><meta property="og:url" content="http://lizhaoloveit.cn/2019/09/25/MongoDB/"><meta property="og:site_name" content="Ammar's Blog"><meta property="og:description" content="MongoDB"><meta property="og:image" content="https://lizhaoloveit.cn/blogimages/blog/avatar.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="prev" title="SpringBoot" href="http://lizhaoloveit.cn/2019/10/01/SpringBoot/"><link rel="next" title="Redis" href="http://lizhaoloveit.cn/2019/09/24/Redis/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?162506e75ffd64287398566b2f5738c8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"VRMKRAV9AT","apiKey":"bd7157400046d0f02396708a501a3480","indexName":"lizhaoloveit","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"cookieDomain":"https://lizhaoloveit.cn/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: '添加书签',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天'

  
}</script><meta name="generator" content="Hexo 4.2.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#简介"><span class="toc-number">1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#下载安装"><span class="toc-number">2.</span> <span class="toc-text">下载安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库结构"><span class="toc-number">3.</span> <span class="toc-text">数据库结构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#语法"><span class="toc-number">4.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据类型"><span class="toc-number">5.</span> <span class="toc-text">数据类型</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#新增操作"><span class="toc-number">6.</span> <span class="toc-text">新增操作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#更新操作"><span class="toc-number">7.</span> <span class="toc-text">更新操作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#删除操作"><span class="toc-number">8.</span> <span class="toc-text">删除操作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#查询操作"><span class="toc-number">9.</span> <span class="toc-text">查询操作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#高级查询"><span class="toc-number">10.</span> <span class="toc-text">高级查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#等值查询"><span class="toc-number">10.1.</span> <span class="toc-text">等值查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#比较查询"><span class="toc-number">10.2.</span> <span class="toc-text">比较查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#逻辑查询："><span class="toc-number">10.3.</span> <span class="toc-text">逻辑查询：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模糊查询"><span class="toc-number">10.4.</span> <span class="toc-text">模糊查询</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#设置用户"><span class="toc-number">11.</span> <span class="toc-text">设置用户</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring-Data-MongoDB"><span class="toc-number">12.</span> <span class="toc-text">Spring Data MongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#操作数据库方案"><span class="toc-number">12.1.</span> <span class="toc-text">操作数据库方案</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MongoRepository"><span class="toc-number">12.2.</span> <span class="toc-text">MongoRepository</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JPA-方法命名规范"><span class="toc-number">12.3.</span> <span class="toc-text">JPA 方法命名规范</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MongoTemplate"><span class="toc-number">12.4.</span> <span class="toc-text">MongoTemplate</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#条件封装-Query"><span class="toc-number">12.4.1.</span> <span class="toc-text">条件封装 Query</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实例代码"><span class="toc-number">12.4.2.</span> <span class="toc-text">实例代码</span></a></li></ol></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://lizhaoloveit.cn/blogimages/blog/top_img.jpg)"><div id="page-header"><span class="pull-left"> <a class="blog_title" id="site-name" href="/">Ammar's Blog</a></span><div class="open toggle-menu pull-right"><div class="menu-icon-first"></div><div class="menu-icon-second"></div><div class="menu-icon-third"></div></div><span class="pull-right menus"><div class="mobile_author_icon"><img class="lozad" data-src="https://lizhaoloveit.cn/blogimages/blog/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'"><div class="mobile_author-info__description">微信号：aicjaish</div></div><hr><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a><a class="site-page" href="/comment/"><i class="fa-fw fa fa-coffee"></i><span> 留言</span></a><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div><div id="post-info"><div id="post-title"><div class="posttitle">MongoDB</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-09-25<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-06-04</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/">Java</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">3.2k</span><span class="post-meta__separator">|</span><span>阅读时长: 13 分钟</span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><hr>
<p>MongoDB 是一个基于分布式文件存储的数据库，由 C++ 语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。是非关系型数据库中功能最丰富，最像关系数据库的。支持数据结构类似 json 的 bson 格式。可以存储比较复杂的数据类型。MongoDB 的查询语言非常强大，类似面向对象的查询语言，几乎可以实现类似数据库单表查询的绝大部分功能，支持对数据建立索引。</p>
<p>高性能(相比关系型数据库)，易部署，易使用。</p>
<p><img src="https://www.lizhaoloveit.cn/blogimages/java/database/mongodb/15693835550814-mangodb.jpg" alt=""></p>
<p>对事务要求不高的业务都能被 MongoDB 取代。分片实现高可用，内部采用轮询的方式进行数据存储。</p>
<h1 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h1><hr>
<p><a href="https://www.jianshu.com/p/f987d4771bf6" target="_blank" rel="noopener">下载安装</a></p>
<h1 id="数据库结构"><a href="#数据库结构" class="headerlink" title="数据库结构"></a>数据库结构</h1><hr>
<p>数据库存储使用的是集合，集合中存储的是文档，即树状结构数据。</p>
<p><img src="https://www.lizhaoloveit.cn/blogimages/java/database/mongodb/15705009878983-mangodb.jpg" alt=""></p>
<p>MongoDB 默认端口 27017</p>
<p><a href="https://www.runoob.com/mongodb/mongodb-tutorial.html" target="_blank" rel="noopener">在线文档教程</a></p>
<h1 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h1><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">show dbs: 查询所有数据库 </span><br><span class="line">use 数据库名: 创建并且选中数据库，数据库已经存在则直接选中 </span><br><span class="line">db: 查询当前选择的数据库 </span><br><span class="line">db.dropDatabase(): 删除当前选中的数据库 </span><br><span class="line">show collections: 查询当前库中的集合 </span><br><span class="line">db.createCollection(&quot;集合名&quot;): 创建集合 </span><br><span class="line">db.集合名.drop(): 删除集合</span><br><span class="line"></span><br><span class="line">注意: db.集合名 &#x3D;&#x3D; db.getCollection(&quot;集合名&quot;)</span><br></pre></td></tr></table></figure>

<h1 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h1><hr>
<p>支持的数据类型：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">String（字符串）: mongodb中的字符串是UTF-8有效的 </span><br><span class="line">Integer（整数）: 存储数值。整数可以是32位或64位，具体取决于您的服务器 </span><br><span class="line">Boolean（布尔）: 存储布尔(true&#x2F;false)值 </span><br><span class="line">Double（双精度）: 存储浮点值 </span><br><span class="line">Arrays（数组）: 将数组或列表或多个值存储到⼀个键中 </span><br><span class="line">Timestamp（时间戳）: 存储时间戳 </span><br><span class="line">Object（对象）: 嵌⼊式⽂档 </span><br><span class="line">Null （空值）: 存储Null值</span><br><span class="line">Symbol（符号）: 与字符串相同，⽤于具有特定符号类型的语⾔ </span><br><span class="line">Date（⽇期）: 以UNIX时间格式存储当前⽇期或时间 </span><br><span class="line">Object ID（对象ID） : 存储⽂档ID </span><br><span class="line">Binary data（⼆进制数据）: 存储⼆进制数据 </span><br><span class="line">Code（代码）: 将JavaScript代码存储到⽂档中 </span><br><span class="line">Regular expression（正则表达式）: 存储正则表达式</span><br></pre></td></tr></table></figure>

<h1 id="新增操作"><a href="#新增操作" class="headerlink" title="新增操作"></a>新增操作</h1><hr>
<p>往集合中新增文档，当集合不存在时，会自动先创建集合，再往集合中添加文档。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.insert(文档)</span><br><span class="line">db.集合名.find() 查询集合中所有文档</span><br></pre></td></tr></table></figure>

<p>操作成功时，会给文档生成一个_id 字段，就是文档的主键。</p>
<ul>
<li>实例</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 插入一个员工对象</span><br><span class="line">db.users.insert(&#123;id: NumberLong(1), name: &quot;小妖&quot;, age: NumberInt(18)&#125;)</span><br><span class="line">db.users.insert(&#123;id: 2, name: &quot;bunny&quot;, age: 20&#125;)</span><br></pre></td></tr></table></figure>

<p>注意，直接写数字默认是 Double 类型。</p>
<h1 id="更新操作"><a href="#更新操作" class="headerlink" title="更新操作"></a>更新操作</h1><hr>
<p>语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.update(</span><br><span class="line">	&lt;query&gt;， </span><br><span class="line">	&lt;update&gt;， </span><br><span class="line">	&#123;</span><br><span class="line">		upsert: &lt;boolean&gt;，</span><br><span class="line">		multi: &lt;boolean&gt;，</span><br><span class="line">		writeConcern: &lt;document&gt; </span><br><span class="line">	&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">简化方法： </span><br><span class="line">更新1个：db.集合名.updateOne( ... ) </span><br><span class="line">更新所有：db.集合名.updateMany( ... )</span><br></pre></td></tr></table></figure>
<p>参数：</p>
<ul>
<li>query: update 查询条件，类似 sql update查询 where 后面的条件</li>
<li>update: update 的对象和一些更新的操作符(如$, $inc) 等，也可以理解为 sql update 查询，set 后面的</li>
<li>upsert: 可选，这个参数的意思是，如果不存在update 的记录，是否插入 objNew，true 为插入，默认是 false，不插入。</li>
<li>multi: 可选，mongodb 默认是 false，只更新找到的第一条记录，如果参数为 true，就把按调价查出来多条记录全部更新。</li>
<li>writeConcern: 可选，抛出异常的级别</li>
</ul>
<p>实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;把一个带有name&#x3D;逍遥的文档，修改其age值为30 </span><br><span class="line">db.employees.updateOne(&#123;name: &quot;逍遥&quot;&#125;, &#123;$set: &#123;age: 30&#125;&#125;)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;修改所有name&#x3D;逍遥的文档，修改其name&#x3D;bunny，age&#x3D;20 </span><br><span class="line">db.employees.updateMany(&#123;name: &quot;逍遥&quot;&#125;， &#123;$set: &#123;name: &quot;bunny&quot;, age: 30&#125;&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="删除操作"><a href="#删除操作" class="headerlink" title="删除操作"></a>删除操作</h1><hr>
<p>语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">db.集合名.remove(</span><br><span class="line">	&lt;query&gt;， </span><br><span class="line">	&#123;</span><br><span class="line">		justOne: &lt;boolean&gt;，</span><br><span class="line">		writeConcern: &lt;document&gt; </span><br><span class="line">	&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">简化方法： </span><br><span class="line">删除1个：db.集合名.deleteOne( ... ) </span><br><span class="line">删除所有：db.集合名.deleteMany( ... )</span><br></pre></td></tr></table></figure>

<ul>
<li>query :（可选）删除的文档的条件。 </li>
<li>justOne : （可选）如果设为 true 或 1，则只删除一个文档，如果不设置该参数，或使用默认值 false，则删除 所有匹配条件的文档。 </li>
<li>writeConcern :（可选）抛出异常的级别</li>
</ul>
<p>实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 删除 _id&#x3D;xxx 的文档</span><br><span class="line">db.users.deleteOne(&#123;_id: objectId(&quot;xxx&quot;)&#125;)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 删除所有带有 name&#x3D;bunny 的文档</span><br><span class="line">db.users.deleteMany(&#123;name: &quot;bunny&quot;&#125;)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 删除当前数据库中所有文档</span><br><span class="line">db.users.deleteMany()</span><br></pre></td></tr></table></figure>

<h1 id="查询操作"><a href="#查询操作" class="headerlink" title="查询操作"></a>查询操作</h1><hr>
<p>语法</p>
<p><code>db.集合名.find(query， projection)</code></p>
<ul>
<li>query: 可选，使用查询操作符指定查询条件</li>
<li>projection: 可选，使用投影操作符指定返回的键。查询时返回文档中所有键值，只需省略该参数即可(默认省略)</li>
</ul>
<p>实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 查询所有文档</span><br><span class="line">db.users.find()</span><br><span class="line">&#x2F;&#x2F; 排序查询</span><br><span class="line">db.users.find().sort(&#123;字段: 1&#125;) -&gt; 按照字段升序排列</span><br><span class="line">db.users.find().sort(&#123;字段: -1&#125;) -&gt; 按照字段降序排列</span><br><span class="line">&#x2F;&#x2F; 分页查询</span><br><span class="line">sikp(num): 跳过 num 个文档，相当于 start</span><br><span class="line">limit(num): 限制显示 num 个文档，相当于 pageSize</span><br><span class="line"></span><br><span class="line">db.users.find().skip(num).limit(num)</span><br><span class="line">需求:按年龄降序排列，查询第二页，每页显示3个</span><br></pre></td></tr></table></figure>

<h1 id="高级查询"><a href="#高级查询" class="headerlink" title="高级查询"></a>高级查询</h1><hr>
<h2 id="等值查询"><a href="#等值查询" class="headerlink" title="等值查询"></a>等值查询</h2><p><code>find({字段: 值})</code></p>
<h2 id="比较查询"><a href="#比较查询" class="headerlink" title="比较查询"></a>比较查询</h2><p><code>find({字段: {比较操作符: 值, ...}})</code></p>
<ul>
<li>大于(&gt;) -&gt; <code>$gt</code></li>
<li>小于(&lt;) -&gt; <code>$lt</code></li>
<li>大于等于(&gt;=) -&gt; <code>$gte</code></li>
<li>小于等于(&lt;=) -&gt; <code>$lte</code></li>
<li>不等于(!=) -&gt; <code>$ne</code></li>
<li>集合运算 -&gt; <code>$in</code>, <code>{name: {$in:[&quot;xiaoyao&quot;, &quot;bunny&quot;]}}</code></li>
<li>判断存在 -&gt; <code>$exists</code>, <code>{name: {$exists: true}}</code></li>
</ul>
<h2 id="逻辑查询："><a href="#逻辑查询：" class="headerlink" title="逻辑查询："></a>逻辑查询：</h2><ul>
<li><code>&amp;&amp; -&gt; $and</code></li>
<li><code>|| -&gt; $or</code></li>
<li><code>! -&gt; $not</code></li>
</ul>
<h2 id="模糊查询"><a href="#模糊查询" class="headerlink" title="模糊查询"></a>模糊查询</h2><p>MongoDB 的模糊查询使用的是正则表达式语法 <code>{name: {$regex:/^.*keyword.*$/}}</code>，实际上 MongoDB 也是不擅长执行模糊查询的，在实际开发中不使用。</p>
<h1 id="设置用户"><a href="#设置用户" class="headerlink" title="设置用户"></a>设置用户</h1><hr>
<p><a href="https://blog.csdn.net/u013066244/article/details/53874216" target="_blank" rel="noopener">用户设置</a></p>
<p>在 MongoDB 的配置文件：安装目录/Server/bin/mongod.cfg 中，如果修改了以下配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 在29行位置，配置开启权限认证</span><br><span class="line">security:</span><br><span class="line">	authorization: enabled</span><br></pre></td></tr></table></figure>

<p>如果完成了上述配置，重启服务器后，登录时需要输入密码，否则不能执行任何命令。</p>
<h1 id="Spring-Data-MongoDB"><a href="#Spring-Data-MongoDB" class="headerlink" title="Spring Data MongoDB"></a>Spring Data MongoDB</h1><hr>
<p>准备工作</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.3.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- lombok插件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.16.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--spring boot data mongodb--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-mongodb<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- pom.xml中添加插件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SpringBoot打包插件 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>配置连接参数</p>
<p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># application.properties </span></span><br><span class="line"><span class="comment"># 配置数据库连接 </span></span><br><span class="line"><span class="comment">#格式: mongodb://账号:密码@ip:端口/数据库?认证数据库 </span></span><br><span class="line"><span class="meta">spring.data.mongodb.uri</span>=<span class="string">mongodb://root:admin@localhost/mongotest?authSource=admin</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置MongoTemplate的执行日志 </span></span><br><span class="line"><span class="meta">logging.level.org.springframework.data.mongodb.core</span>=<span class="string">debug</span></span><br></pre></td></tr></table></figure>

<h2 id="操作数据库方案"><a href="#操作数据库方案" class="headerlink" title="操作数据库方案"></a>操作数据库方案</h2><p>使用，在 MongoDB 中提供了2个方案操作数据库。</p>
<p>高度封装的方案: MongoRepository<br>可以自定义配置方案：MongoTemplate</p>
<h2 id="MongoRepository"><a href="#MongoRepository" class="headerlink" title="MongoRepository"></a>MongoRepository</h2><hr>
<p>该接口对 MongoDB 数据的常用操作进行了封装，只需要写个接口继承该接口就能直接拥有 CRUD 的基本操作，学习 JPA 的方法命名规范，可以完成各种复杂的高级操作，底层会调用 MongoTemplate 方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">  * 自定义一个接口继承 MongoRepository， </span></span><br><span class="line"><span class="comment">  * 泛型1：domain类型 </span></span><br><span class="line"><span class="comment">  * 泛型2：文档主键类型 </span></span><br><span class="line"><span class="comment">  * 贴上<span class="doctag">@Repository</span>注解，底层会创建出动态代理对象，交给Spring管理 </span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="meta">@Repository</span> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMongoRepository</span> <span class="keyword">extends</span> <span class="title">MongoRepository</span>&lt;<span class="title">User</span>, <span class="title">ObjectId</span>&gt; </span>&#123;</span><br><span class="line">	<span class="comment">// 使用Spring Data命名规范做高级查询</span></span><br><span class="line">	<span class="function">List&lt;User&gt; <span class="title">findByName</span><span class="params">(String name)</span></span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>创建接口，放在 respository 包下。使用 Spring-data 的技术，都推荐放在 respository 包下。</p>
<p>需要配置 domain 类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@Document</span>(<span class="string">"users"</span>) <span class="comment">//设置文档所在的集合</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">BaseDomain</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="comment">//文档的id使用ObjectId类型来封装，并且贴上@Id注解</span></span><br><span class="line">    <span class="keyword">private</span> ObjectId _id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="meta">@DateTimeFormat</span></span><br><span class="line">    <span class="keyword">private</span> Date bornDate;</span><br><span class="line">    <span class="keyword">private</span> String headImg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>增删改</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSaveOrUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(repository);</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setName(<span class="string">"lz"</span>);</span><br><span class="line">    user.setAge(<span class="number">19</span>);</span><br><span class="line">    System.out.println(user); </span><br><span class="line">    <span class="comment">// User(_id=null, name=lz, age=19, bornDate=null, headImg=null)</span></span><br><span class="line">    repository.save(user); <span class="comment">// 插入数据库</span></span><br><span class="line">    System.out.println(user); </span><br><span class="line">    <span class="comment">// User(_id=5d9c4cde8670510a18497809, name=lz, age=19, bornDate=null, headImg=null)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果配置了 id,调用 save 方法就是修改操作。<br>日志如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">2019-10-08 16:46:22.062 DEBUG 2584 --- [           main] o.s.data.mongodb.core.MongoTemplate      : Inserting Document containing fields: [name, age, _class] in collection: users</span><br><span class="line">2019-10-08 16:46:22.107  INFO 2584 --- [           main] org.mongodb.driver.connection            : Opened connection [connectionId&#123;localValue:2, serverValue:10&#125;] to 127.0.0.1:27017</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2019-10-08 16:54:58.307 DEBUG 2636 --- [           main] o.s.data.mongodb.core.MongoTemplate      : Saving Document containing fields: [_id, name, age, _class]</span><br><span class="line">2019-10-08 16:54:58.342  INFO 2636 --- [           main] org.mongodb.driver.connection            : Opened connection [connectionId&#123;localValue:2, serverValue:12&#125;] to 127.0.0.1:27017</span><br></pre></td></tr></table></figure>
<p>inserting 新增，saving 更新，removing 删除</p>
<p>查询：查多个</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuery</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;User&gt; list = repository.findAll();</span><br><span class="line">    list.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * PageRequest.of(page, size, sort)</span></span><br><span class="line"><span class="comment"> * 参数1：页数</span></span><br><span class="line"><span class="comment"> * 参数2：页面容量</span></span><br><span class="line"><span class="comment"> * 参数3：Sort.By(排序字段)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Page&lt;User&gt; page = repository.findAll(PageRequest.of(<span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">page.getContent().forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testget</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Optional&lt;User&gt; byId = repository.findById(<span class="keyword">new</span> ObjectId(<span class="string">"5d9c4cde8670510a18497809"</span>));</span><br><span class="line">    byId.ifPresent(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="JPA-方法命名规范"><a href="#JPA-方法命名规范" class="headerlink" title="JPA 方法命名规范"></a>JPA 方法命名规范</h2><hr>
<p>只要符合 JPA 方法命名规范，不需要写方法实现。</p>
<table>
<thead>
<tr>
<th>关键字</th>
<th>例子</th>
<th>JPQL</th>
</tr>
</thead>
<tbody><tr>
<td>And</td>
<td>ﬁndByNameAndAge(String name, Integer age)</td>
<td>where name = ? and age = ?</td>
</tr>
<tr>
<td>Or</td>
<td>findByNameOrAge(String name, Integer age)</td>
<td>where name = ? or age = ?</td>
</tr>
<tr>
<td>Is</td>
<td>findByName(String name)</td>
<td>where name = ?</td>
</tr>
<tr>
<td>Between</td>
<td>findByAgeBetween(Integer min, Integer max)</td>
<td>where age between ? and ?</td>
</tr>
<tr>
<td>LessThan</td>
<td>findByAgeLessThan(Integer age)</td>
<td>where age &lt; ?</td>
</tr>
<tr>
<td>LessThanEqual</td>
<td>findByIdLessThanEqual</td>
<td>where id &lt;= ?</td>
</tr>
<tr>
<td>GreaterThan</td>
<td>findByIdGreaterThan</td>
<td>where id &gt; ?</td>
</tr>
<tr>
<td>GreaterThanEqual</td>
<td>findByIdGreaterThanEqual</td>
<td>where id &gt; = ?</td>
</tr>
<tr>
<td>After</td>
<td>findByIdAfter</td>
<td>where id &gt; ?</td>
</tr>
<tr>
<td>Before</td>
<td>findByIdBefore</td>
<td>where id &lt; ?</td>
</tr>
<tr>
<td>IsNull</td>
<td>findByNameIsNull</td>
<td>where name is null</td>
</tr>
<tr>
<td>isNotNull,NotNull</td>
<td>findByNameNotNull</td>
<td>where name is not null</td>
</tr>
<tr>
<td>Like</td>
<td>findByNameLike</td>
<td>where name like ?</td>
</tr>
<tr>
<td>NotLike</td>
<td>findByNameNotLike</td>
<td>where name not like ?</td>
</tr>
<tr>
<td>StartingWith</td>
<td>findByNameStartingWith</td>
<td>where name like ‘?%’</td>
</tr>
<tr>
<td>EndingWith</td>
<td>findByNameEndingWith</td>
<td>where name like ‘%?’</td>
</tr>
<tr>
<td>Containing</td>
<td>findByNameContaining</td>
<td>where name like ‘%?%’</td>
</tr>
<tr>
<td>OrderBy</td>
<td>findByIdOrderByXDesc</td>
<td>where id=? order by x desc</td>
</tr>
<tr>
<td>Not</td>
<td>findByNameNot</td>
<td>where name &lt;&gt; ?</td>
</tr>
<tr>
<td>In</td>
<td>findByIdIn(Collection&lt;?&gt; c)</td>
<td>where id in (?)</td>
</tr>
<tr>
<td>NotIn</td>
<td>findByIdNotIn(Collection&lt;?&gt; c)</td>
<td>where id not  in (?)</td>
</tr>
<tr>
<td>True</td>
<td>findByAaaTue</td>
<td>where aaa = true</td>
</tr>
<tr>
<td>False</td>
<td>findByAaaFalse</td>
<td>where aaa = false</td>
</tr>
<tr>
<td>IgnoreCase</td>
<td>findByNameIgnoreCase</td>
<td>where UPPER(name)=UPPER(?)</td>
</tr>
</tbody></table>
<h2 id="MongoTemplate"><a href="#MongoTemplate" class="headerlink" title="MongoTemplate"></a>MongoTemplate</h2><hr>
<p>SpringBoot 完成了自动配置，直接注入即可。依靠该对象可以完成任何 MongoDB 操作，一般和 MongoRepository 分工合作，多数用于复杂的高级查询以及底层操作。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> MongoTemplate template;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据条件查询集合中的文档</span></span><br><span class="line">List&lt;T&gt; mongoTemplate.find(Query query, Class&lt;T&gt; type, String collectionName);</span><br></pre></td></tr></table></figure>

<h3 id="条件封装-Query"><a href="#条件封装-Query" class="headerlink" title="条件封装 Query"></a>条件封装 Query</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一个 Ctriteria 对象，可以理解为一个条件</span></span><br><span class="line">Criteria.where(String key).is(Object val); <span class="comment">// 设置一个等值条件</span></span><br><span class="line">Criteria.orOperator(Criteria...); <span class="comment">// 设置一组条件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 模糊查询</span></span><br><span class="line">Criteria.where(String key).regex(String regex); <span class="comment">// 使用正则表达式查询</span></span><br><span class="line"><span class="comment">// Criteria 对象静态方法和构造器获取，封装了所有的条件描述，lt / lte / gt / gte / ne /...</span></span><br></pre></td></tr></table></figure>

<p>最后通过 addCriteria 把条件封装到 Query 对象中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Query对象.addCriteria(Criteria criteria); <span class="comment">// 添加查询条件</span></span><br><span class="line">Query对象.skip(start).limit(pageSize); <span class="comment">// 分页查询</span></span><br></pre></td></tr></table></figure>

<h3 id="实例代码"><a href="#实例代码" class="headerlink" title="实例代码"></a>实例代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> MongoTemplate mongoTemplate;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 分页查询文档，显示第2页，每页显示3个，按照id升序排列 @Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuery1</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建查询对象</span></span><br><span class="line">    Query query = <span class="keyword">new</span> Query();</span><br><span class="line">    <span class="comment">// 设置分页信息</span></span><br><span class="line">    query.skip(<span class="number">3</span>).limit(<span class="number">3</span>);</span><br><span class="line">    <span class="comment">// 设置排序规则</span></span><br><span class="line">    query.with(<span class="keyword">new</span> Sort(Sort.Direction.ASC, <span class="string">"id"</span>));</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; list = mongoTemplate.find(query, User.class, <span class="string">"users"</span>);</span><br><span class="line">    list.forEach(System.err::println);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询所有name为bunny的文档 </span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuery2</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构建限制条件 &#123;"name": "bunny"&#125; </span></span><br><span class="line">    Criteria criteria = Criteria.where(<span class="string">"name"</span>).is(<span class="string">"bunny"</span>);</span><br><span class="line">    <span class="comment">// 创建查询对象 </span></span><br><span class="line">    Query query = <span class="keyword">new</span> Query(); <span class="comment">// 添加限制条件</span></span><br><span class="line">    query.addCriteria(criteria);</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; list = mongoTemplate.find(query, User.class, <span class="string">"users"</span>);</span><br><span class="line">    list.forEach(System.err::println);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询所有name为bunny或者age&lt;30的文档 </span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuery3</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构建限制条件 &#123; "$or": [&#123;"name": "bunny"&#125;, &#123;"age": &#123;"$lt": 30&#125;&#125;] &#125; </span></span><br><span class="line">    Criteria criteria = <span class="keyword">new</span> Criteria().orOperator(</span><br><span class="line"></span><br><span class="line">            Criteria.where(<span class="string">"name"</span>).is(<span class="string">"bunny"</span>),</span><br><span class="line"></span><br><span class="line">            Criteria.where(<span class="string">"age"</span>).lt(<span class="number">30</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建查询对象 </span></span><br><span class="line">    Query query = <span class="keyword">new</span> Query();</span><br><span class="line">    <span class="comment">// 添加限制条件 </span></span><br><span class="line">    query.addCriteria(criteria);</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; list = mongoTemplate.find(query, User.class, <span class="string">"users"</span>);</span><br><span class="line">    list.forEach(System.err::println);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询所有name含有wang并且30&lt;=age&lt;=32的文档 </span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuery4</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// 构建限制条件 &#123; "$and" : [&#123;"name": &#123;"$regex": ".*wang.*"&#125; &#125;, &#123;"age": &#123;"$gte": 30, "$lte": 32 &#125; &#125;] &#125; </span></span><br><span class="line">    Criteria criteria = <span class="keyword">new</span> Criteria().andOperator(Criteria.where(<span class="string">"name"</span>).regex(<span class="string">".*wang.*"</span>), Criteria.where(<span class="string">"age"</span>).gte(<span class="number">30</span>).lte(<span class="number">32</span>));</span><br><span class="line">    <span class="comment">// 创建查询对象 </span></span><br><span class="line">    Query query = <span class="keyword">new</span> Query();</span><br><span class="line">    <span class="comment">// 添加限制条件 </span></span><br><span class="line">    query.addCriteria(criteria);</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; list = mongoTemplate.find(query, User.class, <span class="string">"users"</span>);</span><br><span class="line">    list.forEach(System.err::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Ammar</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://lizhaoloveit.cn/2019/09/25/MongoDB/">http://lizhaoloveit.cn/2019/09/25/MongoDB/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://lizhaoloveit.cn">Ammar's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库    </a></div><div class="post_share"><div class="social-share" data-image="https://lizhaoloveit.cn/blogimages/blog/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-buttom"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lozad post-qr-code__img" data-src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lozad post-qr-code__img" data-src="/img/alipay.jpg"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull-left"><a href="/2019/10/01/SpringBoot/"><img class="prev_cover lozad" data-src="https://www.lizhaoloveit.cn/blogimages/blog/cover/1.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/2.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/3.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/4.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/5.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/6.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/7.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/8.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/9.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/10.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/11.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/12.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/13.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/14.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/15.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/16.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/17.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/18.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/19.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/20.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/21.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/22.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/23.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/24.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/25.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/26.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/27.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/28.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/29.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/31.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/32.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/33.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/34.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/35.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/36.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/37.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/38.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/39.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/40.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/41.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/42.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/43.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/44.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/45.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/46.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/47.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/48.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/49.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/50.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/51.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/52.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/53.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/54.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/55.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/56.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/57.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/58.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/59.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/60.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/62.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/63.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/64.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/65.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/66.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/67.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/68.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/69.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/70.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/71.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/72.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/73.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/74.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/75.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/76.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/77.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/78.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/79.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>SpringBoot</span></div></a></div><div class="next-post pull-right"><a href="/2019/09/24/Redis/"><img class="next_cover lozad" data-src="https://www.lizhaoloveit.cn/blogimages/blog/cover/1.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/2.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/3.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/4.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/5.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/6.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/7.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/8.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/9.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/10.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/11.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/12.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/13.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/14.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/15.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/16.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/17.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/18.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/19.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/20.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/21.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/22.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/23.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/24.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/25.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/26.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/27.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/28.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/29.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/31.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/32.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/33.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/34.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/35.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/36.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/37.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/38.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/39.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/40.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/41.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/42.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/43.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/44.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/45.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/46.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/47.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/48.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/49.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/50.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/51.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/52.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/53.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/54.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/55.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/56.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/57.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/58.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/59.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/60.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/62.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/63.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/64.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/65.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/66.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/67.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/68.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/69.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/70.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/71.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/72.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/73.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/74.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/75.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/76.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/77.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/78.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/79.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>Redis</span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div id="disqus_thread"></div><script>var unused = null;
var disqus_config = function () {
  this.page.url = 'http://lizhaoloveit.cn/2019/09/25/MongoDB/';
  this.page.identifier = '2019/09/25/MongoDB/';
  this.page.title = 'MongoDB';
}
var d = document, s = d.createElement('script');
s.src = "https://" + 'lizhao' +".disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script></div></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2014 - 2023 By Ammar</div><div class="icp"><a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener"><span>浙ICP备19013619号-1</span></a></div><div class="bag"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33010502006128" target="_blank" rel="noopener"><img src="/img/beian.png"><span>浙公网安备 33010502006128号</span></a></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><section class="rightside" id="rightside"><i class="fa fa-book" id="readmode" title="阅读模式"> </i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换">繁</a><i class="far fa-moon nightshift" id="nightshift" title="夜间模式"></i></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script async src="/js/search/algolia.js"></script><script src="/js/nightshift.js"></script><script src="/js/tw_cn.js"></script><script>translateInitilization()

</script><script src="https://cdn.jsdelivr.net/npm/instant.page@1.2.2/instantpage.min.js" type="module"></script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>