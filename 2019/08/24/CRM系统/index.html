<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>CRM系统 | Ammar's Blog</title><meta name="description" content="CRM系统"><meta name="keywords" content="Java"><meta name="author" content="Ammar"><meta name="copyright" content="Ammar"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.1/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="http://lizhaoloveit.cn/2019/08/24/CRM%E7%B3%BB%E7%BB%9F/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="CRM系统"><meta name="twitter:description" content="CRM系统"><meta name="twitter:image" content="https://lizhaoloveit.cn/blogimages/blog/avatar.jpg"><meta property="og:type" content="article"><meta property="og:title" content="CRM系统"><meta property="og:url" content="http://lizhaoloveit.cn/2019/08/24/CRM%E7%B3%BB%E7%BB%9F/"><meta property="og:site_name" content="Ammar's Blog"><meta property="og:description" content="CRM系统"><meta property="og:image" content="https://lizhaoloveit.cn/blogimages/blog/avatar.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="prev" title="Shiro权限框架" href="http://lizhaoloveit.cn/2019/08/25/Shiro%E6%9D%83%E9%99%90%E6%A1%86%E6%9E%B6/"><link rel="next" title="IDEA安装JRebel插件实现热更新(21-9-25)" href="http://lizhaoloveit.cn/2019/08/23/IDEA%E5%AE%89%E8%A3%85JRebel%E6%8F%92%E4%BB%B6%E5%AE%9E%E7%8E%B0%E7%83%AD%E6%9B%B4%E6%96%B0/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><link rel="dns-prefetch" href="https://hm.baidu.com"><script><!-- hexo-inject:begin --><!-- hexo-inject:end -->var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?162506e75ffd64287398566b2f5738c8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"VRMKRAV9AT","apiKey":"bd7157400046d0f02396708a501a3480","indexName":"lizhaoloveit","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"cookieDomain":"https://lizhaoloveit.cn/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: '添加书签',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天'

  
}</script><meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#FreeMarker"><span class="toc-number">1.</span> <span class="toc-text">FreeMarker</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么使用-FreeMarker"><span class="toc-number">1.1.</span> <span class="toc-text">为什么使用 FreeMarker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FreeMarker-的简单实用"><span class="toc-number">1.2.</span> <span class="toc-text">FreeMarker 的简单实用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Freemarker-语法"><span class="toc-number">1.3.</span> <span class="toc-text">Freemarker 语法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#分页插件-Pagehelper"><span class="toc-number">2.</span> <span class="toc-text">分页插件 Pagehelper</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#模态框"><span class="toc-number">3.</span> <span class="toc-text">模态框</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#使用模态框完成添加和修改操作"><span class="toc-number">3.1.</span> <span class="toc-text">使用模态框完成添加和修改操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jQuery-消息提示框插件"><span class="toc-number">3.2.</span> <span class="toc-text">jQuery 消息提示框插件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据绑定"><span class="toc-number">4.</span> <span class="toc-text">数据绑定</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#异步请求"><span class="toc-number">5.</span> <span class="toc-text">异步请求</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Shiro-权限框架"><span class="toc-number">6.</span> <span class="toc-text">Shiro 权限框架</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#统一的异常处理"><span class="toc-number">7.</span> <span class="toc-text">统一的异常处理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#批量删除"><span class="toc-number">8.</span> <span class="toc-text">批量删除</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#导入-x2F-导出-excel"><span class="toc-number">9.</span> <span class="toc-text">导入&#x2F;导出(excel)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据管理：字典"><span class="toc-number">10.</span> <span class="toc-text">数据管理：字典</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#客户管理"><span class="toc-number">11.</span> <span class="toc-text">客户管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#潜在客户操作"><span class="toc-number">11.1.</span> <span class="toc-text">潜在客户操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#客户池"><span class="toc-number">11.2.</span> <span class="toc-text">客户池</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#报表"><span class="toc-number">12.</span> <span class="toc-text">报表</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#设计sql"><span class="toc-number">12.1.</span> <span class="toc-text">设计sql</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#设计查询-queryObject"><span class="toc-number">12.2.</span> <span class="toc-text">设计查询 queryObject</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#柱状图和饼状图"><span class="toc-number">12.3.</span> <span class="toc-text">柱状图和饼状图</span></a></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://lizhaoloveit.cn/blogimages/blog/top_img.jpg)"><div id="page-header"><span class="pull-left"> <a class="blog_title" id="site-name" href="/">Ammar's Blog</a></span><div class="open toggle-menu pull-right"><div class="menu-icon-first"></div><div class="menu-icon-second"></div><div class="menu-icon-third"></div></div><span class="pull-right menus"><div class="mobile_author_icon"><img class="lozad" data-src="https://lizhaoloveit.cn/blogimages/blog/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'"><div class="mobile_author-info__description">微信号：aicjaish</div></div><hr><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a><a class="site-page" href="/comment/"><i class="fa-fw fa fa-coffee"></i><span> 留言</span></a><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div><div id="post-info"><div id="post-title"><div class="posttitle">CRM系统</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-08-24<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-09-05</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/">Java</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/%E5%BA%94%E7%94%A8/">应用</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/%E5%BA%94%E7%94%A8/CRM%E7%B3%BB%E7%BB%9F/">CRM系统</a></span><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">9.6k</span><span class="post-meta__separator">|</span><span>阅读时长: 43 分钟</span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><blockquote>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><p>思想：设计前端的一些页面，直接找<a href="http://www.jq22.com/" target="_blank" rel="noopener">插件</a>，不要直接自己做。</p>
</blockquote>
<h1 id="FreeMarker"><a href="#FreeMarker" class="headerlink" title="FreeMarker"></a>FreeMarker</h1><hr>
<p>FreeMarker，其实就是一个静态的网页生成工具，它本身不依托任何容器(web，服务器)，将业务数据按照模板内容生成静态网页。<br>FreeMarker最初的设计，是用来在 MVC 模式的 Web 开发框架中生成 HTML 的。没有被绑定到 Servlet、HTML 或者任意 Web 相关的东西上。</p>
<p><img src="https://www.lizhaoloveit.cn/blogimages/java/application/rbac/15666341017081-freemarker.jpg"></p>
<h2 id="为什么使用-FreeMarker"><a href="#为什么使用-FreeMarker" class="headerlink" title="为什么使用 FreeMarker"></a>为什么使用 FreeMarker</h2><p>这里就拿传统的 jsp 来比较。我们知道 jsp 文件是需要 Tomcat等服务器容器去解析并且会变成字节码文件的，最终是由字节码去输出页面。</p>
<p>思考，哪些隐患？</p>
<ul>
<li>jsp 不够纯粹，其内部既有 Java 代码，又有前端代码，而且如果前端程序员想要调试页面，必须在后端环境下去调试。并且协同开发时，后台和前端同时开发 jsp 文件会有冲突等等问题。</li>
<li>jsp 中的代码是会在内存中的 Code 区域占用内存的，如果页面代码非常多，会导致 Code 内存溢出。</li>
</ul>
<p>FreeMarker 模板不会编译成字节码对象，不会占用 PermGen 空间，可以理解为不会占用内存区域存放 Code 的空间。所以前端工程师开发页面不需要后台环境，专注数据如何展示。<br>Freemarker 就像复制粘贴，替换。完工。专注于替换值，所以性能比较好。</p>
<h2 id="FreeMarker-的简单实用"><a href="#FreeMarker-的简单实用" class="headerlink" title="FreeMarker 的简单实用"></a>FreeMarker 的简单实用</h2><ul>
<li>导入组件 <code>spring-context-support</code>，选择对应版本的 <code>freemarker</code></li>
<li>在 java 下创建 templates Package，存放所有的 freemarker 模板，并创建模板文件 <code>product.ftl</code></li>
</ul>
<p>product.ftl</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">产品名称：$&#123;name&#125;</span><br><span class="line">产品价格：$&#123;price&#125;</span><br><span class="line">设计作者：&lt;#list users as user&gt; $&#123;user&#125; &lt;&#x2F;#list&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>创建测试类 FreemarkerTest.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testss</span><span class="params">()</span> <span class="keyword">throws</span> IOException, TemplateException </span>&#123;</span><br><span class="line">    <span class="comment">// 创建一个freemarker.templates.Configuration实例，它是存储 FreeMarker 应用级设置的核心部分</span></span><br><span class="line">    <span class="comment">// 指定版本号</span></span><br><span class="line">    Configuration cfg = <span class="keyword">new</span> Configuration(Configuration.VERSION_2_3_22);</span><br><span class="line">    <span class="comment">// 设置模板目录</span></span><br><span class="line">    cfg.setDirectoryForTemplateLoading(<span class="keyword">new</span> File(<span class="string">"src/main/java/templates"</span>));</span><br><span class="line">    <span class="comment">// 设置默认编码格式</span></span><br><span class="line">    cfg.setDefaultEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//数据</span></span><br><span class="line">    Map&lt;String, Object&gt; product = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    product.put(<span class="string">"name"</span>, <span class="string">"Huwei P8"</span>);</span><br><span class="line">    product.put(<span class="string">"price"</span>, <span class="string">"3985.7"</span>);</span><br><span class="line">    product.put(<span class="string">"users"</span>, <span class="keyword">new</span> String[]&#123;<span class="string">"Tom"</span>, <span class="string">"Jack"</span>, <span class="string">"Rose"</span>&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//从设置的目录中获得模板</span></span><br><span class="line">    Template temp = cfg.getTemplate(<span class="string">"product.ftl"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//合并模板和数据模型</span></span><br><span class="line">    Writer out = <span class="keyword">new</span> OutputStreamWriter(System.out);</span><br><span class="line">    temp.process(product, out);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//关闭</span></span><br><span class="line">    out.flush();</span><br><span class="line">    out.close();</span><br><span class="line">&#125;</span><br><span class="line">-----------产品详情------------</span><br><span class="line">产品名称：Huwei P8</span><br><span class="line">产品价格：<span class="number">3985.7</span></span><br><span class="line">设计作者： Tom  Jack  Rose </span><br><span class="line">------------------------------</span><br></pre></td></tr></table></figure>

<p>如果在项目中使用，在 mvc 中配置 FreemarkerConfigurer 和 FreemarkerViewResolver。<br>mvc.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- FreemarkerConfig 配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"freemarkerConfig"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.freemarker.FreeMarkerConfigurer"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 配置 freemarker 寻找模板的路径 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"templateLoaderPath"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/view/"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 配置 freemarker 的文件编码 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultEncoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">&lt;!-- 配置freemarker视图解析器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.freemarker.FreeMarkerViewResolver"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 是否在 model 自动把 session 中的 attribute 导入进去 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"exposeSessionAttributes"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 配置输出的HTML的 ContentType 属性 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"contentType"</span> <span class="attr">value</span>=<span class="string">"text/html;charset=UTF-8"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 自动添加后缀 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".ftl"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>在解析 ftl 文件时，一旦${name} name值为空就会报错，也会停止解析</strong></p>
<h2 id="Freemarker-语法"><a href="#Freemarker-语法" class="headerlink" title="Freemarker 语法"></a>Freemarker 语法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br></pre></td><td class="code"><pre><span class="line">&lt;#if (entity.permissions)??&gt;</span><br><span class="line">    &lt;#list entity.permissions as p&gt;</span><br><span class="line">        &lt;option value&#x3D;&quot;$&#123;p.id&#125;&quot;&gt;$&#123;p.name&#125;&lt;&#x2F;option&gt;</span><br><span class="line">    &lt;&#x2F;#list&gt;</span><br><span class="line">&lt;&#x2F;#if&gt;</span><br><span class="line"></span><br><span class="line">FTL指令常用标签及语法</span><br><span class="line">注意：使用freemaker，要求所有标签必须闭合，否则会导致freemaker无法解析。</span><br><span class="line"></span><br><span class="line">freemaker注释:&lt;#-- 注释内容 --&gt;格式部分,不会输出</span><br><span class="line"></span><br><span class="line">---------------------------------- 基础语法 ----------------------------------</span><br><span class="line">1、字符输出</span><br><span class="line">$&#123;emp.name?if_exists&#125;　　　　　　&#x2F;&#x2F; 变量存在，输出该变量，否则不输出</span><br><span class="line">$&#123;emp.name!&#125;　　　　　　　　　　 &#x2F;&#x2F; 变量存在，输出该变量，否则不输出</span><br><span class="line">$&#123;emp.name?default(&quot;xxx&quot;)&#125; &#x2F;&#x2F; 变量不存在，取默认值xxx</span><br><span class="line"> $&#123;emp.name!&quot;xxx&quot;&#125; 　　　　　　&#x2F;&#x2F; 变量不存在，取默认值xxx</span><br><span class="line"></span><br><span class="line">常用内部函数：</span><br><span class="line">$&#123;&quot;123&lt;br&gt;456&quot;?html&#125; 　　&#x2F;&#x2F; 对字符串进行HTML编码，对html中特殊字符进行转义</span><br><span class="line">$&#123;&quot;str&quot;?cap_first&#125; 　　 &#x2F;&#x2F; 使字符串第一个字母大写 </span><br><span class="line">$&#123;&quot;Str&quot;?lower_case&#125; &#x2F;&#x2F; 将字符串转换成小写</span><br><span class="line"> $&#123;&quot;Str&quot;?upper_case&#125; &#x2F;&#x2F; 将字符串转换成大写</span><br><span class="line">$&#123;&quot;str&quot;?trim&#125; &#x2F;&#x2F; 去掉字符串前后的空白字符</span><br><span class="line"></span><br><span class="line">字符串的两种拼接方式拼接：</span><br><span class="line">$&#123;&quot;hello$&#123;emp.name!&#125;&quot;&#125; &#x2F;&#x2F; 输出hello+变量名</span><br><span class="line">$&#123;&quot;hello&quot;+emp.name!&#125; &#x2F;&#x2F; 使用+号来连接，输出hello+变量名</span><br><span class="line"></span><br><span class="line">可以通过如下语法来截取子串:</span><br><span class="line">&lt;#assign str &#x3D; &quot;abcdefghijklmn&quot;&#x2F;&gt;</span><br><span class="line">&#x2F;&#x2F; 方法1$&#123;str?substring(0,4)&#125; &#x2F;&#x2F; 输出abcd</span><br><span class="line">&#x2F;&#x2F; 方法2$&#123;str[0]&#125;$&#123;str[4]&#125; &#x2F;&#x2F; 结果是ae</span><br><span class="line">$&#123;str[1..4]&#125; 　　　 &#x2F;&#x2F; 结果是bcde&#x2F;&#x2F; 返回指定字符的索引$&#123;str?index_of(&quot;n&quot;)&#125;</span><br><span class="line"></span><br><span class="line">2、日期输出</span><br><span class="line">$&#123;emp.date?string(&#39;yyyy-MM-dd&#39;)&#125; &#x2F;&#x2F;日期格式</span><br><span class="line"></span><br><span class="line">3、数字输出(以数字20为例)</span><br><span class="line">$&#123;emp.name?string.number&#125; 　&#x2F;&#x2F; 输出20</span><br><span class="line">$&#123;emp.name?string.currency&#125; &#x2F;&#x2F; ￥20.00 </span><br><span class="line">$&#123;emp.name?string.percent&#125; &#x2F;&#x2F; 20%</span><br><span class="line">$&#123;1.222?int&#125; 　　　　　　　　　　 &#x2F;&#x2F; 将小数转为int，输出1</span><br><span class="line">&lt;#setting number_format&#x3D;&quot;percent&quot;&#x2F;&gt; &#x2F;&#x2F; 设置数字默认输出方式(&#39;percent&#39;,百分比)</span><br><span class="line">&lt;#assign answer&#x3D;42&#x2F;&gt; 　　　　　　　　 &#x2F;&#x2F; 声明变量 answer 42</span><br><span class="line">#&#123;answer&#125; 　　　　　　　　 &#x2F;&#x2F; 输出 4,200%</span><br><span class="line">$&#123;answer?string&#125; 　　　　 &#x2F;&#x2F; 输出 4,200%</span><br><span class="line">$&#123;answer?string.number&#125; 　　&#x2F;&#x2F; 输出 42</span><br><span class="line">$&#123;answer?string.currency&#125; &#x2F;&#x2F; 输出 ￥42.00</span><br><span class="line">$&#123;answer?string.percent&#125; 　&#x2F;&#x2F; 输出 4,200%</span><br><span class="line">#&#123;answer&#125; 　　　　　　　　&#x2F;&#x2F; 输出 42</span><br><span class="line"></span><br><span class="line">数字格式化插值可采用#&#123;expr;format&#125;形式来格式化数字,其中format可以是:</span><br><span class="line">mX:小数部分最小X位</span><br><span class="line">MX:小数部分最大X位</span><br><span class="line">如下面的例子:</span><br><span class="line">&lt;#assign x&#x3D;2.582&#x2F;&gt;&lt;#assign y&#x3D;4&#x2F;&gt;#&#123;x; M2&#125; &#x2F;&#x2F; 输出2.58</span><br><span class="line">#&#123;y; M2&#125; &#x2F;&#x2F; 输出4</span><br><span class="line">#&#123;x; m2&#125; &#x2F;&#x2F; 输出2.58</span><br><span class="line">#&#123;y; m2&#125; &#x2F;&#x2F; 输出4.0</span><br><span class="line">#&#123;x; m1M2&#125; &#x2F;&#x2F; 输出2.58</span><br><span class="line">#&#123;x; m1M2&#125; &#x2F;&#x2F; 输出4.0</span><br><span class="line"></span><br><span class="line">4、申明变量</span><br><span class="line">&lt;#assign foo&#x3D;false&#x2F;&gt; </span><br><span class="line">&#x2F;&#x2F; 声明变量,插入布尔值进行显示,注意不要用引号$&#123;foo?string(&quot;yes&quot;,&quot;no&quot;)&#125; </span><br><span class="line">&#x2F;&#x2F; 当为true时输出&quot;yes&quot;,否则输出&quot;no&quot;</span><br><span class="line"></span><br><span class="line">申明变量的几种方式</span><br><span class="line">&lt;#assign name&#x3D;value&gt;</span><br><span class="line"> &lt;#assign name1&#x3D;value1 name2&#x3D;value2 ... nameN&#x3D;valueN&gt;</span><br><span class="line"> &lt;#assign same as above... in namespacehash&gt;</span><br><span class="line">&lt;#assign name&gt; capture this &lt;&#x2F;#assign&gt;</span><br><span class="line">&lt;#assign name in namespacehash&gt; capture this &lt;&#x2F;#assign&gt;</span><br><span class="line"></span><br><span class="line">5、比较运算符</span><br><span class="line">表达式中支持的比较运算符有如下几个:&#x3D; 或 &#x3D;&#x3D; ：判断两个值是否相等.</span><br><span class="line">!&#x3D; ：判断两个值是否不等.</span><br><span class="line">&gt; 或 gt ：判断左边值是否大于右边值</span><br><span class="line">&gt;&#x3D; 或 gte ：判断左边值是否大于等于右边值</span><br><span class="line">&lt; 或 lt ：判断左边值是否小于右边值</span><br><span class="line">&lt;&#x3D; 或 lte ：判断左边值是否小于等于右边值</span><br><span class="line">6、算术运算符</span><br><span class="line">FreeMarker表达式中完全支持算术运算,FreeMarker支持的算术运算符包括:+, - , * , &#x2F; , % 注意：</span><br><span class="line">（1）、运算符两边必须是数字</span><br><span class="line">（2）、使用+运算符时,如果一边是数字,一边是字符串,就会自动将数字转换为字符串再连接,如:$&#123;3 + &quot;5&quot;&#125;,结果是:35</span><br><span class="line">7、逻辑运算符</span><br><span class="line">逻辑运算符有如下几个:逻辑与:&amp;&amp;逻辑或:||逻辑非:!逻辑运算符只能作用于布尔值,否则将产生错误</span><br><span class="line">8、FreeMarker中的运算符优先级如下(由高到低排列):</span><br><span class="line">①、一元运算符:!</span><br><span class="line">②、内建函数:?</span><br><span class="line">③、乘除法:*, &#x2F; , %</span><br><span class="line">④、加减法:- , +</span><br><span class="line">⑤、比较:&gt; , &lt; , &gt;&#x3D; , &lt;&#x3D; (lt , lte , gt , gte)</span><br><span class="line">⑥、相等:&#x3D;&#x3D; , &#x3D; , !&#x3D;</span><br><span class="line">⑦、逻辑与:&amp;&amp;</span><br><span class="line">⑧、逻辑或:||</span><br><span class="line">⑨、数字范围:..实际上,我们在开发过程中应该使用括号来严格区分,这样的可读性好,出错少</span><br><span class="line">9、if 逻辑判断（注意：elseif 不加空格）</span><br><span class="line">&lt;#if condition&gt;</span><br><span class="line">...</span><br><span class="line">&lt;#elseif condition2&gt;</span><br><span class="line">...</span><br><span class="line">&lt;#elseif condition3&gt;</span><br><span class="line">...</span><br><span class="line">&lt;#else&gt;</span><br><span class="line">...</span><br><span class="line">&lt;&#x2F;#if&gt;</span><br><span class="line"></span><br><span class="line">if 空值判断</span><br><span class="line">&#x2F;&#x2F; 当 photoList 不为空时&lt;#if photoList??&gt;...&lt;&#x2F;#if&gt; </span><br><span class="line">值得注意的是,$&#123;..&#125;只能用于文本部分,不能用于表达式,</span><br><span class="line">下面的代码是错误的:</span><br><span class="line">&lt;#if $&#123;isBig&#125;&gt;Wow!&lt;&#x2F;#if&gt;&lt;#if &quot;$&#123;isBig&#125;&quot;&gt;Wow!&lt;&#x2F;#if&gt;</span><br><span class="line">&#x2F;&#x2F; 正确写法&lt;#if isBig&gt;Wow!&lt;&#x2F;#if&gt;</span><br><span class="line"></span><br><span class="line">10、switch (条件可为数字，可为字符串)</span><br><span class="line">&lt;#switch value&gt;</span><br><span class="line"> &lt;#case refValue1&gt;</span><br><span class="line"> ....</span><br><span class="line">&lt;#break&gt; </span><br><span class="line">&lt;#case refValue2&gt; </span><br><span class="line">....</span><br><span class="line">&lt;#break&gt;</span><br><span class="line"> &lt;#case refValueN&gt;</span><br><span class="line"> ....</span><br><span class="line">&lt;#break&gt;</span><br><span class="line"> &lt;#default&gt;</span><br><span class="line"> ....</span><br><span class="line"> &lt;&#x2F;#switch&gt;</span><br><span class="line">11、集合 &amp; 循环</span><br><span class="line">&#x2F;&#x2F; 遍历集合:</span><br><span class="line">&lt;#list empList! as emp&gt; </span><br><span class="line">    $&#123;emp.name!&#125;</span><br><span class="line">&lt;&#x2F;#list&gt;</span><br><span class="line">&#x2F;&#x2F; 可以这样遍历集合:</span><br><span class="line">&lt;#list 0..(empList!?size-1) as i&gt;</span><br><span class="line">    $&#123;empList[i].name!&#125;</span><br><span class="line">&lt;&#x2F;#list&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 与jstl循环类似,也可以访问循环的状态。</span><br><span class="line"></span><br><span class="line">empList?size 　　　&#x2F;&#x2F; 取集合的长度</span><br><span class="line">emp_index: 　　　　&#x2F;&#x2F; int类型，当前对象的索引值 </span><br><span class="line">emp_has_next:     &#x2F;&#x2F; boolean类型，是否存在下一个对象</span><br><span class="line">&#x2F;&#x2F; 使用&lt;#break&gt;跳出循环</span><br><span class="line">&lt;#if emp_index &#x3D; 0&gt;&lt;#break&gt;&lt;&#x2F;#if&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 集合长度判断 </span><br><span class="line">&lt;#if empList?size !&#x3D; 0&gt;&lt;&#x2F;#if&gt; &#x2F;&#x2F; 判断&#x3D;的时候,注意只要一个&#x3D;符号,而不是&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">&lt;#assign l&#x3D;0..100&#x2F;&gt;    &#x2F;&#x2F; 定义一个int区间的0~100的集合，数字范围也支持反递增,如100..2</span><br><span class="line">&lt;#list 0..100 as i&gt; 　　&#x2F;&#x2F; 等效于java for(int i&#x3D;0; i &lt;&#x3D; 100; i++)</span><br><span class="line">　　$&#123;i&#125;</span><br><span class="line">&lt;&#x2F;#list&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 截取子集合：</span><br><span class="line">empList[3..5] &#x2F;&#x2F;返回empList集合的子集合,子集合中的元素是empList集合中的第4-6个元素</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 创建集合：</span><br><span class="line">&lt;#list [&quot;星期一&quot;, &quot;星期二&quot;, &quot;星期三&quot;, &quot;星期四&quot;, &quot;星期五&quot;, &quot;星期六&quot;, &quot;星期天&quot;] as x&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 集合连接运算,将两个集合连接成一个新的集合</span><br><span class="line">&lt;#list [&quot;星期一&quot;,&quot;星期二&quot;,&quot;星期三&quot;] + [&quot;星期四&quot;,&quot;星期五&quot;,&quot;星期六&quot;,&quot;星期天&quot;] as x&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 除此之外,集合元素也可以是表达式,例子如下:</span><br><span class="line">[2 + 2, [1, 2, 3, 4], &quot;whatnot&quot;]</span><br><span class="line">&#x2F; seq_contains：判断序列中的元素是否存在</span><br><span class="line">&lt;#assign x &#x3D; [&quot;red&quot;, 16, &quot;blue&quot;, &quot;cyan&quot;]&gt; </span><br><span class="line">$&#123;x?seq_contains(&quot;blue&quot;)?string(&quot;yes&quot;, &quot;no&quot;)&#125;    &#x2F;&#x2F; yes</span><br><span class="line">$&#123;x?seq_contains(&quot;yellow&quot;)?string(&quot;yes&quot;, &quot;no&quot;)&#125;  &#x2F;&#x2F; no</span><br><span class="line">$&#123;x?seq_contains(16)?string(&quot;yes&quot;, &quot;no&quot;)&#125;        &#x2F;&#x2F; yes</span><br><span class="line">$&#123;x?seq_contains(&quot;16&quot;)?string(&quot;yes&quot;, &quot;no&quot;)&#125;      &#x2F;&#x2F; no</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; seq_index_of：第一次出现的索引</span><br><span class="line">&lt;#assign x &#x3D; [&quot;red&quot;, 16, &quot;blue&quot;, &quot;cyan&quot;, &quot;blue&quot;]&gt; </span><br><span class="line">$&#123;x?seq_index_of(&quot;blue&quot;)&#125;  &#x2F;&#x2F; 2</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; sort_by：排序（升序）</span><br><span class="line">&lt;#list movies?sort_by(&quot;showtime&quot;) as movie&gt;&lt;&#x2F;#list&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; sort_by：排序（降序）</span><br><span class="line">&lt;#list movies?sort_by(&quot;showtime&quot;)?reverse as movie&gt;&lt;&#x2F;#list&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 具体介绍：</span><br><span class="line">&#x2F;&#x2F; 不排序的情况：</span><br><span class="line">&lt;#list movies as moive&gt;</span><br><span class="line">　　&lt;a href&#x3D;&quot;$&#123;moive.url&#125;&quot;&gt;$&#123;moive.name&#125;&lt;&#x2F;a&gt;</span><br><span class="line">&lt;&#x2F;#list&gt;</span><br><span class="line">&#x2F;&#x2F;要是排序，则用</span><br><span class="line">&lt;#list movies?sort as movie&gt;</span><br><span class="line">　　&lt;a href&#x3D;&quot;$&#123;movie.url&#125;&quot;&gt;$&#123;movie.name&#125;&lt;&#x2F;a&gt;</span><br><span class="line">&lt;&#x2F;#list&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 这是按元素的首字母排序。若要按list中对象元素的某一属性排序的话，则用</span><br><span class="line">&lt;#list moives?sort_by([&quot;name&quot;]) as movie&gt;</span><br><span class="line">　　&lt;a href&#x3D;&quot;$&#123;movie.url&#125;&quot;&gt;$&#123;movie.name&#125;&lt;&#x2F;a&gt;</span><br><span class="line">&lt;&#x2F;#list&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;这个是按list中对象元素的[name]属性排序的，是升序，如果需要降序的话，如下所示：</span><br><span class="line">&lt;#list movies?sort_by([&quot;name&quot;])?reverse as movie&gt;</span><br><span class="line">　　&lt;a href&#x3D;&quot;$&#123;movie.url&#125;&quot;&gt;$&#123;movie.name&#125;&lt;&#x2F;a&gt;</span><br><span class="line">&lt;&#x2F;#list&gt;</span><br><span class="line">12、Map对象</span><br><span class="line">&#x2F;&#x2F; 创建map</span><br><span class="line">&lt;#assign scores &#x3D; &#123;&quot;语文&quot;:86,&quot;数学&quot;:78&#125;&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Map连接运算符</span><br><span class="line">&lt;#assign scores &#x3D; &#123;&quot;语文&quot;:86,&quot;数学&quot;:78&#125; + &#123;&quot;数学&quot;:87,&quot;Java&quot;:93&#125;&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Map元素输出</span><br><span class="line">emp.name       &#x2F;&#x2F; 全部使用点语法</span><br><span class="line">emp[&quot;name&quot;]    &#x2F;&#x2F; 使用方括号</span><br><span class="line"></span><br><span class="line">13、FreeMarker支持如下转义字符:</span><br><span class="line">\&quot; ：双引号(u0022)</span><br><span class="line">\&#39; ：单引号(u0027)</span><br><span class="line">\\ ：反斜杠(u005C)</span><br><span class="line">\n ：换行(u000A)</span><br><span class="line">\r ：回车(u000D)</span><br><span class="line">\t ：Tab(u0009)</span><br><span class="line">\b ：退格键(u0008)</span><br><span class="line">\f ：Form feed(u000C)</span><br><span class="line">\l ：&lt;</span><br><span class="line">\g ：&gt;</span><br><span class="line">\a ：&amp;</span><br><span class="line">\&#123; ：&#123;</span><br><span class="line">\xCode ：直接通过4位的16进制数来指定Unicode码,输出该unicode码对应的字符.</span><br><span class="line"></span><br><span class="line">如果某段文本中包含大量的特殊符号,FreeMarker提供了另一种特殊格式:</span><br><span class="line">可以在指定字符串内容的引号前增加r标记,在r标记后的文件将会直接输出.看如下代码:</span><br><span class="line">$&#123;r&quot;$&#123;foo&#125;&quot;&#125;    &#x2F;&#x2F; 输出 $&#123;foo&#125;</span><br><span class="line">$&#123;r&quot;C:&#x2F;foo&#x2F;bar&quot;&#125;    &#x2F;&#x2F; 输出 C:&#x2F;foo&#x2F;bar</span><br><span class="line">14、include指令</span><br><span class="line">&#x2F;&#x2F; include指令的作用类似于JSP的包含指令:</span><br><span class="line">&lt;#include &quot;&#x2F;test.ftl&quot; encoding&#x3D;&quot;UTF-8&quot; parse&#x3D;true&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 在上面的语法格式中,两个参数的解释如下:</span><br><span class="line">encoding&#x3D;&quot;GBK&quot;  &#x2F;&#x2F; 编码格式</span><br><span class="line">parse&#x3D;true 　　 &#x2F;&#x2F; 是否作为ftl语法解析,默认是true，false就是以文本方式引入,</span><br><span class="line">注意:在ftl文件里布尔值都是直接赋值的如parse&#x3D;true,而不是parse&#x3D;&quot;true&quot;</span><br><span class="line"></span><br><span class="line">15、import指令</span><br><span class="line">&#x2F;&#x2F; 类似于jsp里的import,它导入文件，然后就可以在当前文件里使用被导入文件里的宏组件</span><br><span class="line">&lt;#import &quot;&#x2F;libs&#x2F;mylib.ftl&quot; as my&gt;</span><br><span class="line">&#x2F;&#x2F; 上面的代码将导入&#x2F;lib&#x2F;common.ftl模板文件中的所有变量,</span><br><span class="line">交将这些变量放置在一个名为com的Map对象中，</span><br><span class="line">&quot;my&quot;在freemarker里被称作namespace</span><br><span class="line"></span><br><span class="line">16、compress 压缩</span><br><span class="line">&#x2F;&#x2F; 用来压缩空白空间和空白的行 </span><br><span class="line">&lt;#compress&gt; </span><br><span class="line">    ... </span><br><span class="line">&lt;&#x2F;#compress&gt;</span><br><span class="line">&lt;#t&gt; &#x2F;&#x2F; 去掉左右空白和回车换行 </span><br><span class="line"></span><br><span class="line">&lt;#lt&gt;&#x2F;&#x2F; 去掉左边空白和回车换行 </span><br><span class="line"></span><br><span class="line">&lt;#rt&gt;&#x2F;&#x2F; 去掉右边空白和回车换行 </span><br><span class="line"></span><br><span class="line">&lt;#nt&gt;&#x2F;&#x2F; 取消上面的效果</span><br><span class="line">17、escape,noescape 对字符串进行HTML编码</span><br><span class="line">&#x2F;&#x2F; escape指令导致body区的插值都会被自动加上escape表达式,</span><br><span class="line">但不会影响字符串内的插值,只会影响到body内出现的插值,</span><br><span class="line">使用escape指令的语法格式如下:</span><br><span class="line">&lt;#escape x as x?html&gt; </span><br><span class="line">　　First name: $&#123;firstName&#125; </span><br><span class="line">&lt;#noescape&gt;Last name: $&#123;lastName&#125;&lt;&#x2F;#noescape&gt; </span><br><span class="line">　　Maiden name: $&#123;maidenName&#125; </span><br><span class="line">&lt;&#x2F;#escape&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 相同表达式</span><br><span class="line">First name: $&#123;firstName?html&#125; </span><br><span class="line">Last name: $&#123;lastName&#125; </span><br><span class="line">Maiden name: $&#123;maidenName?html&#125;</span><br><span class="line"></span><br><span class="line">---------------------------------- 高级语法 ----------------------------------</span><br><span class="line">1、global全局赋值语法</span><br><span class="line">&lt;#global name&#x3D;value&gt; </span><br><span class="line"></span><br><span class="line">&lt;#global name1&#x3D;value1 name2&#x3D;value2 ... nameN&#x3D;valueN&gt; </span><br><span class="line"></span><br><span class="line">&lt;#global name&gt; </span><br><span class="line">　　capture this </span><br><span class="line">&lt;&#x2F;#global&gt;</span><br><span class="line">&#x2F;&#x2F; 利用这个语法给变量赋值，那么这个变量在所有的namespace中是可见的，</span><br><span class="line">如果这个变量被当前的assign语法覆盖如&lt;#global x&#x3D;2&gt;&lt;#assign x&#x3D;1&gt;在当前页面里x&#x3D;2将被隐藏，</span><br><span class="line">或者通过$&#123;.globals.x&#125; 来访问</span><br><span class="line">2、setting 语法</span><br><span class="line">&#x2F;&#x2F; 用来设置整个系统的一个环境 </span><br><span class="line">locale &#x2F;&#x2F; zh_CN 中文环境</span><br><span class="line">number_format </span><br><span class="line">boolean_format </span><br><span class="line">date_format , time_format , datetime_format </span><br><span class="line">time_zone </span><br><span class="line">classic_compatible</span><br><span class="line">&#x2F;&#x2F; 例1：</span><br><span class="line">&lt;#setting number_format&#x3D;&quot;percent&quot;&#x2F;&gt;    &#x2F;&#x2F; 设置数字默认输出方式(&#39;percent&#39;,百分比)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 例2：</span><br><span class="line">&#x2F;&#x2F; 假如当前是匈牙利的设置，然后修改成美国</span><br><span class="line">$&#123;1.2&#125; &#x2F;&#x2F; 输出1,2</span><br><span class="line">&lt;#setting locale&#x3D;&quot;en_US&quot;&gt; </span><br><span class="line">$&#123;1.2&#125; &#x2F;&#x2F; 输出1.2,因为匈牙利是采用&quot;, &quot;作为十进制的分隔符，美国是用&quot;. &quot;</span><br><span class="line">3、macro宏指令</span><br><span class="line">例子1：</span><br><span class="line"></span><br><span class="line">&lt;#-- 定义宏 --&gt;</span><br><span class="line">&lt;#macro test foo bar&#x3D;&quot;Bar&quot; baaz&#x3D;-1&gt; </span><br><span class="line">　　Text: $&#123;foo&#125;, $&#123;bar&#125;, $&#123;baaz&#125;</span><br><span class="line">&lt;&#x2F;#macro&gt;</span><br><span class="line"></span><br><span class="line">&lt;#-- 使用宏 --&gt;</span><br><span class="line">&lt;@test foo&#x3D;&quot;a&quot; bar&#x3D;&quot;b&quot; baaz&#x3D;5*5&#x2F;&gt;  &#x2F;&#x2F; 输出：Text: a, b, 25</span><br><span class="line">&lt;@test foo&#x3D;&quot;a&quot; bar&#x3D;&quot;b&quot;&#x2F;&gt;    　　　　&#x2F;&#x2F; 输出：Text: a, b, -1</span><br><span class="line">&lt;@test foo&#x3D;&quot;a&quot; baaz&#x3D;5*5-2&#x2F;&gt; 　　　　&#x2F;&#x2F; 输出：Text: a, Bar, 23</span><br><span class="line">&lt;@test foo&#x3D;&quot;a&quot;&#x2F;&gt;                   &#x2F;&#x2F; 输出：Text: a, Bar, -1</span><br><span class="line">例子2：</span><br><span class="line"></span><br><span class="line">&lt;#-- 定义一个循环输出的宏 --&gt;</span><br><span class="line">&lt;#macro list title items&gt; </span><br><span class="line">　　$&#123;title&#125;</span><br><span class="line">　　&lt;#list items as x&gt;</span><br><span class="line">　　　　*$&#123;x&#125;</span><br><span class="line">　　&lt;&#x2F;#list&gt; </span><br><span class="line">&lt;&#x2F;#macro&gt; </span><br><span class="line"></span><br><span class="line">&lt;#-- 使用宏 --&gt;</span><br><span class="line">&lt;@list items&#x3D;[&quot;mouse&quot;, &quot;elephant&quot;, &quot;python&quot;] title&#x3D;&quot;Animals&quot;&#x2F;&gt;</span><br><span class="line">&#x2F;&#x2F; 输出Animals *mouse *elephant *python</span><br><span class="line">例子3：</span><br><span class="line"></span><br><span class="line">&lt;#-- 嵌套宏 --&gt;</span><br><span class="line">&lt;#macro border&gt;</span><br><span class="line">　　&lt;table&gt;</span><br><span class="line">　　　　&lt;#nested&gt;</span><br><span class="line">　　&lt;&#x2F;table&gt;</span><br><span class="line">&lt;&#x2F;#macro&gt;</span><br><span class="line"></span><br><span class="line">&lt;#-- 嵌套宏使用 --&gt;</span><br><span class="line">&lt;@border&gt;</span><br><span class="line">　　&lt;tr&gt;&lt;td&gt;hahaha&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;</span><br><span class="line">&lt;&#x2F;@border&gt; </span><br><span class="line">输出结果：</span><br><span class="line">&lt;table&gt;</span><br><span class="line">　　&lt;tr&gt;&lt;td&gt;hahaha&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;</span><br><span class="line">&lt;&#x2F;table&gt;</span><br><span class="line"> 例子4：在nested指令中使用循环变量时,可以使用多个循环变量,看如下代码:</span><br><span class="line">&lt;#-- 循环嵌套宏 --&gt;&lt;#macro repeat count&gt;　　</span><br><span class="line">&lt;#list 1..count as x&gt;</span><br><span class="line">&lt;#nested x, x&#x2F;2, x&#x3D;&#x3D;count&gt;</span><br><span class="line"> &#x2F;&#x2F; 使用nested指令时指定了三个循环变量　　</span><br><span class="line">&lt;&#x2F;#list&gt;&lt;&#x2F;#macro&gt;&lt;#-- 使用宏 --&gt;</span><br><span class="line">&lt;@repeat count &#x3D; 4; c, halfc, last&gt;　　</span><br><span class="line">$&#123;c&#125;. $&#123;halfc&#125;&lt;#if last&gt; Last!&lt;&#x2F;#if&gt;&lt;&#x2F;@repeat&gt;</span><br><span class="line">&#x2F;&#x2F; 输出结果：&#x2F;&#x2F; 1. 0.5&#x2F;&#x2F; 2. 1&#x2F;&#x2F; 3. 1.5&#x2F;&#x2F; 4. 2 Last!</span><br><span class="line"></span><br><span class="line">freemarker 宏嵌套nested 的使用:http:&#x2F;&#x2F;blog.sina.com.cn&#x2F;s&#x2F;blog_7e5699790100z59g.html</span><br><span class="line"></span><br><span class="line">4、结束macro指令</span><br><span class="line">&#x2F;&#x2F; return指令用于结束macro指令</span><br><span class="line">&lt;#-- 创建宏 --&gt;</span><br><span class="line">&lt;#macro book&gt;</span><br><span class="line">　　spring</span><br><span class="line">　　&lt;#return&gt;</span><br><span class="line">　　j2ee</span><br><span class="line">&lt;&#x2F;#macro&gt;</span><br><span class="line"></span><br><span class="line">&lt;#-- 使用宏 --&gt;</span><br><span class="line">&lt;@book &#x2F;&gt;</span><br><span class="line">&#x2F;&#x2F; 上面的代码输出:spring,而j2ee位于return指令之后,不会输出.</span><br></pre></td></tr></table></figure>

<p>输出中间含有 , 的list</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;#list [&quot;hello&quot;,&quot;world&quot;] as word&gt;</span><br><span class="line">    &lt;span&gt;$&#123;word&#125;&lt;&#x2F;span&gt;&lt;#if word_has_next&gt;,&lt;&#x2F;#if&gt;</span><br><span class="line">&lt;&#x2F;#list&gt;</span><br></pre></td></tr></table></figure>


<h1 id="分页插件-Pagehelper"><a href="#分页插件-Pagehelper" class="headerlink" title="分页插件 Pagehelper"></a>分页插件 Pagehelper</h1><hr>
<p><a href="https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/en/HowToUse.md" target="_blank" rel="noopener">PageHelper</a></p>
<p>mysql 中，分页的 sql 是 limit 做的，一旦 model 多了复杂了，就会想到使用 mybatis 的逆向工程来生成响应的 po 和 mapper，但是同时会带来弊端，分页就不好解决了。可以手动修改，可是一般来说，逆向生成的文件一般都不会去动。所以需要使用一个分页插件解决。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- mybatis分页插件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在 Mybatis 配置拦截器插件</p>
<p>applicationContext.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 3.创建 sqlSEssion --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span> <span class="attr">id</span>=<span class="string">"mySqlSession"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:mappers/*"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeAliasesPackage"</span> <span class="attr">value</span>=<span class="string">"cn.lizhaoloveit.crm"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configurationProperties"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">            lazyLoadingEnabled=true</span><br><span class="line">            aggressiveLazyLoading=false</span><br><span class="line">            lazyLoadTriggerMethods=equals,clone,hashCode</span><br><span class="line">        <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 注意其他配置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"plugins"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.github.pagehelper.PageInterceptor"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"properties"</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--当pageNum&lt;=0时，将pageNum设置为1--&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--当pageNum&gt;pages时，将pageNum设置为pages--&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                        reasonable=true</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>相当于在 mybatis.xml 添加</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- com.github.pagehelper为PageHelper类所在包名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">"com.github.pagehelper.PageInterceptor"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--当pageNum&lt;=0时，将pageNum设置为1--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--当pageNum&gt;pages时，将pageNum设置为pages--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"reasonable"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>


<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@Transactional</span>(readOnly = <span class="keyword">true</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> PageInfo&lt;Department&gt; <span class="title">gets</span><span class="params">(QueryName qn)</span> </span>&#123;</span><br><span class="line">    PageHelper.startPage(qn.getPageNum(), qn.getPageSize());</span><br><span class="line">    List&lt;Department&gt; list = departmentMapper.selectAll(qn);</span><br><span class="line">    PageHelper.startPage(qn.getPageNum(), qn.getPageSize());</span><br><span class="line">    Integer totalCount = departmentMapper.totalCount(qn);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> PageInfo&lt;&gt;(list, totalCount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="模态框"><a href="#模态框" class="headerlink" title="模态框"></a>模态框</h1><hr>
<h2 id="使用模态框完成添加和修改操作"><a href="#使用模态框完成添加和修改操作" class="headerlink" title="使用模态框完成添加和修改操作"></a>使用模态框完成添加和修改操作</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">#--部门编辑模态框--</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal fade"</span> <span class="attr">id</span>=<span class="string">"editModal"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span> <span class="attr">aria-label</span>=<span class="string">"Close"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"modal-title"</span>&gt;</span>部门编辑<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span> <span class="comment">&lt;!-- 后面是我们填充的内容 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span> <span class="attr">action</span>=<span class="string">"/department/saveOrUpdate"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">id</span>=<span class="string">"editForm"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"pageNum"</span> <span class="attr">id</span>=<span class="string">"pageNum"</span> <span class="attr">value</span>=<span class="string">$&#123;qn.pageNum&#125;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">name</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span> &gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">label</span>  <span class="attr">class</span>=<span class="string">"col-sm-3 control-label"</span>&gt;</span>部门名称：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-6"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">placeholder</span>=<span class="string">"请输入部门名称"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">label</span>  <span class="attr">class</span>=<span class="string">"col-sm-3 control-label"</span>&gt;</span>部门编号：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-6"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span>  <span class="attr">name</span>=<span class="string">"sn"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">placeholder</span>=<span class="string">"请输入部门编号"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-footer"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btnSubmit"</span> &gt;</span>保存<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span> &gt;</span>取消<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>js 代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    $(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 保存回显</span></span><br><span class="line">        $(<span class="string">'.btnUpdate'</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// 打开 modal 之前加载数据</span></span><br><span class="line">            <span class="keyword">var</span> data = $(<span class="keyword">this</span>).data(<span class="string">'json'</span>)</span><br><span class="line">            <span class="comment">// console.log($('#editForm input[name="id"]').attr('name'));</span></span><br><span class="line">            $(<span class="string">'#editForm input[name="id"]'</span>).val(data.id)</span><br><span class="line">            $(<span class="string">'#editForm input[name="name"]'</span>).val(data.name)</span><br><span class="line">            $(<span class="string">'#editForm input[name="sn"]'</span>).val(data.sn)</span><br><span class="line">            $(<span class="string">'#editModal'</span>).modal(<span class="string">'show'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// 添加</span></span><br><span class="line">        $(<span class="string">'.btnSubmit'</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            $(<span class="string">'#editForm'</span>).submit()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<p>模态框显示其他页面</p>
<h2 id="jQuery-消息提示框插件"><a href="#jQuery-消息提示框插件" class="headerlink" title="jQuery 消息提示框插件"></a>jQuery 消息提示框插件</h2><p><code>jquery.messager.js</code>，处理在逻辑执行完以后的提示操作</p>
<ul>
<li>confirm(e, v, f) 带回调方法，带两个按钮</li>
<li>alert(e, v) 不带回调方法，带一个按钮</li>
<li>popup(e) 没有按钮</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 删除</span></span><br><span class="line">    $(<span class="string">".btn_delete"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> url = $(<span class="keyword">this</span>).data(<span class="string">"url"</span>);</span><br><span class="line">        <span class="keyword">var</span> formId = $(<span class="keyword">this</span>).data(<span class="string">"formid"</span>);</span><br><span class="line">        $.messager.confirm(<span class="string">"温馨提示"</span>, <span class="string">"你确定要删除此数据吗?"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// 删除</span></span><br><span class="line">            $.<span class="keyword">get</span>(url, function (data) &#123;</span><br><span class="line">                <span class="keyword">if</span> (data.success) &#123;</span><br><span class="line">                    <span class="comment">// 删除成功</span></span><br><span class="line">                    $.messager.confirm(<span class="string">"温馨提示"</span>, <span class="string">"删除成功"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                        $(<span class="string">'#'</span> + formId).submit()</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">//删除失败</span></span><br><span class="line">                    $.messager.popup(data.msg);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="数据绑定"><a href="#数据绑定" class="headerlink" title="数据绑定"></a>数据绑定</h1><hr>
<p>使用场景，当从数据库中拉取数据时，就已经将数据内容拿到了，此时在做一些当前页面回显数据的时候，如果还要到后台去数据库再拿一遍相同的数据，实属浪费。因此使用数据绑定，将拿到的数据绑定到事件上，在触发事件时就可以拿到当前数据。</p>
<p>data-json</p>
<ul>
<li>在按钮标签上加入 data-json 属性</li>
</ul>
<p>list.ftl</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-info btn-xs btn-info btnUpdate"</span> <span class="attr">href</span>=<span class="string">"javascript:;"</span> <span class="attr">data-json</span>=<span class="string">'$&#123;entity.jsonStr!&#125;'</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> 编辑</span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>${entity.jsonStr!} 表示调用对象的 getJsonStr 方法，将返回值赋值给 data-json</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JSONField</span>(serialize = <span class="keyword">false</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getJsonStr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> JSON.toJSONString(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：需要加 @JSONField(serialize &#x3D; false) 注解，表示该属性(getXxx也表示属性) 不会被序列化，不然会出现栈溢出，自己体会为什么(底层序列化会通过 getXxx 去获取属性的值拼接字符串)。</p>
</blockquote>
<p>最后页面中的 html 标签就带有了具体值的 data-json 属性了</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-info btn-xs btn-info btnUpdate"</span> <span class="attr">href</span>=<span class="string">"javascript:;"</span> <span class="attr">data-json</span>=<span class="string">"&#123;"</span><span class="attr">id</span>"<span class="attr">:1</span>,"<span class="attr">name</span>"<span class="attr">:</span>"天宫部","<span class="attr">sn</span>"<span class="attr">:</span>"<span class="attr">IOS-8859-1</span>"&#125;""&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> 编辑</span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="异步请求"><a href="#异步请求" class="headerlink" title="异步请求"></a>异步请求</h1><hr>
<p>在执行一些请求时，需要根据响应结果做一些事情，这时候直接访问后台资源刷新页面就不是特别合适。最好使用异步请求，即只通过 Ajax 请求，获取数据，而不重新生成页面。</p>
<p>这时就可以通过后台响应的结果信息使用 js 做一些操作。</p>
<p>解决方案：</p>
<ol>
<li>自己手动使用 ajax 发送异步请求。详情见 <a href="https://www.lizhaoloveit.cn/2019/03/31/Ajax/#Ajax-%E5%AE%9E%E7%8E%B0%E7%99%BB%E5%BD%95" target="_blank" rel="noopener">Ajax实现登录</a></li>
<li>使用 jquery-form 插件</li>
</ol>
<p><strong>使用 jquery-form 插件需要引入库</strong><br><code>&lt;script type=&quot;text/javascript&quot; src=&quot;/js/plugins/jquery-form/jquery.form.js&quot;&gt;&lt;/script&gt;</code></p>
<p>情况一：表单自带提交按钮</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	$(<span class="string">"#testForm"</span>).ajaxForm(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.debug(data)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;form id=<span class="string">"testForm"</span> action=<span class="string">"/text.do"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">	&lt;input type=<span class="string">"submit"</span> value=<span class="string">"提交"</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/form&gt;</span></span><br></pre></td></tr></table></figure>

<p>情况二：表单不带有提交按钮，而是普通按钮，需要手动提交</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	$(<span class="string">"#btn_test"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		$(<span class="string">"#testForm"</span>).submit();</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	$(<span class="string">"#testForm"</span>).ajaxForm(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.debug(data)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;form id=<span class="string">"testForm"</span> action=<span class="string">"/text.do"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">	&lt;input type=<span class="string">"submit"</span> value=<span class="string">"提交"</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/form&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="Shiro-权限框架"><a href="#Shiro-权限框架" class="headerlink" title="Shiro 权限框架"></a>Shiro 权限框架</h1><hr>
<p>见<a href="https://www.lizhaoloveit.cn/2019/08/25/Shiro%E6%9D%83%E9%99%90%E6%A1%86%E6%9E%B6/#Spring-%E4%B8%8E-Shiro-%E6%95%B4%E5%90%88" target="_blank" rel="noopener">Shiro权限框架章节</a></p>
<h1 id="统一的异常处理"><a href="#统一的异常处理" class="headerlink" title="统一的异常处理"></a>统一的异常处理</h1><hr>
<p>方式一：SpringMVC 的统一异常处理。</p>
<p>mvc.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.SimpleMappingExceptionResolver"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 定义默认的异常处理页面 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultErrorView"</span> <span class="attr">value</span>=<span class="string">"common/error"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 定义需要特殊处理的异常，使用类名或完全路径名作为 Key，异常页作为值 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"exceptionMappings"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">			org.apache.shiro.authz.UnauthorizedException=common/nopermission</span><br><span class="line">		<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>方式二：使用 ControllerAdvice，来自定义统一的异常</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyExceptionAdvice</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExceptionHandler</span>(RuntimeException.class)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">handleException</span><span class="params">(HttpServletResponse response, Model model, RuntimeException e)</span> </span>&#123;</span><br><span class="line">        model.addAttribute(<span class="string">"exception"</span>, <span class="string">"出错了"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"common/error"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h1 id="批量删除"><a href="#批量删除" class="headerlink" title="批量删除"></a>批量删除</h1><hr>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    $(<span class="string">'#checkAll'</span>).change(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        $(<span class="string">'.selectOne'</span>).prop(<span class="string">'checked'</span>, $(<span class="keyword">this</span>).prop(<span class="string">'checked'</span>))</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    $(<span class="string">'.btn_batchDelete'</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 1.如果没有选择 给出提示</span></span><br><span class="line">        <span class="keyword">if</span> ($(<span class="string">'.selectOne:checked'</span>).length == <span class="number">0</span>) &#123;</span><br><span class="line">            $.messager.alert(<span class="string">"温馨提示"</span>, <span class="string">"请选择要删除的数据"</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果选择了，确认提示</span></span><br><span class="line">        $.messager.confirm(<span class="string">"温馨提示"</span>, <span class="string">"您确定要删除所选项吗？"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// 获取要删除数据的id</span></span><br><span class="line">            <span class="keyword">var</span> checks = $(<span class="string">'.selectOne:checked'</span>);</span><br><span class="line">            <span class="keyword">var</span> ids = []; <span class="comment">// 创建数组</span></span><br><span class="line">            $.each(checks, <span class="function"><span class="keyword">function</span> (<span class="params">index, checkBox</span>) </span>&#123;</span><br><span class="line">                ids.push($(checkBox).data(<span class="string">'id'</span>))</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="comment">// 发送 ajax请求(携带要删除数据的 id)</span></span><br><span class="line">            $.<span class="keyword">get</span>('/employee/batchDelete', &#123;ids: ids&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (data.success) &#123;</span><br><span class="line">                    $.messager.confirm(<span class="string">"温馨提示"</span>, <span class="string">"删除成功"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                        $(<span class="string">'#searchForm'</span>).submit()</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    $.messager.alert(<span class="string">"温馨提示"</span>, <span class="string">"删除失败"</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&lt;td&gt;<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">class</span>=<span class="string">"cb selectOne"</span> <span class="attr">data-id</span>=<span class="string">"$&#123;entity.id&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>思路，前端页面，</p>
<ol>
<li>如果没有选择，给出提示</li>
<li>如果选择了，提示用户确认</li>
<li>获取要删除的数据 id</li>
<li>发送 ajax 请求(携带删除数据的 id)</li>
</ol>
<p>后端：</p>
<p>先删关系，再删员工</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteFromEmpRoleBatch"</span>&gt;</span></span><br><span class="line">    delete from emp_role where emp_id in</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"array"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">close</span>=<span class="string">")"</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">item</span>=<span class="string">"empId"</span>&gt;</span></span><br><span class="line">        #&#123;empId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteBatch"</span>&gt;</span></span><br><span class="line">    delete from employee where id in</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"array"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">close</span>=<span class="string">")"</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">item</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">        #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="导入-x2F-导出-excel"><a href="#导入-x2F-导出-excel" class="headerlink" title="导入&#x2F;导出(excel)"></a>导入&#x2F;导出(excel)</h1><hr>
<p>框架：</p>
<ul>
<li>阿里出品的 easyExcel</li>
<li>easyPoi(注解工具)</li>
</ul>
<p>其中涉及的文件上传与下载的知识，请查看文章<a href="https://www.lizhaoloveit.cn/2019/08/09/SpringMVC%E4%B9%8B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD/#%E5%AF%BC%E5%85%A5%E3%80%81%E5%AF%BC%E5%87%BA-excel" target="_blank" rel="noopener">文件上传与下载</a></p>
<h1 id="数据管理：字典"><a href="#数据管理：字典" class="headerlink" title="数据管理：字典"></a>数据管理：字典</h1><hr>
<p>系统中管理业务数据的字典。数据的分类：字典目录(system_dictionary)，字典目录明细(system_dictionary_item)<br>字典目录主要存放要描述一个对象的一系列的行为或者状态的抽象概念。</p>
<p>比如我们如果要描述一个人，那么字典目录应该为：收入、职业、文凭、住址(城市)、年龄等等。其中，我们需要对数据进行规范，因此有了字典目录明细的概念，我们会对职业数据规范，你只能从医生、老师、司机、老板、学生等等词语中选择，对数据进行规范有利于后期对数据进行处理、分析等。</p>
<p>再比如，如果要描述一次销售行为，字典目录应该为，来源、意向程度、收款类型、客户重要程度、交流方式、跟进情况等等。而目录可以有明细。</p>
<p>说白了，字典的作用就是规范数据。将以后我们可能会使用到的数据进行规范。字典目录和字典目录明细是一对多关系。</p>
<h1 id="客户管理"><a href="#客户管理" class="headerlink" title="客户管理"></a>客户管理</h1><hr>
<p>这里的客户管理，指的是销售员工对应的客户，也就是说这些客户是这名销售拉过来的。<br>CRM 最终要的类目就是客户管理了，客户虽然只有一张表，但是对客户分类和描述需要一些辅助，目前的 CRM 练手项目中，对客户进行分类为 潜在客户、客户池、失败客户、正式客户、流失客户。</p>
<p>潜在客户表示为有意向的客户，但没有继续深入。<br>失败客户表示潜在客户谈崩了，进入失败客户列表，那谈成功了，就会进入正式客户列表。<br>在正式客户列表中，最终没有交易成功，或者不可抗力因素造成交易失败的客户就是流失客户了。</p>
<p>客户池比较特殊，因为潜在客户中有些客户比较难搞，可能大半年了还未交易，负责该客户的员工不想再跟进了，于是把该客户置入了客户池。客户池的员工所有其他员工应都可见。</p>
<p>建表：<br>id name gender age tel qq job_id 这些都是用户属性。<br>source_id 来源：客户从哪来的<br>seller_id 员工id，哪个销售的客户<br>inputUser_id 是谁创建的用户<br>input_time 创建时间<br>status 状态 0 潜在客户、1 客户池、2 失败客户、3 正式客户、4 流失客户</p>
<h2 id="潜在客户操作"><a href="#潜在客户操作" class="headerlink" title="潜在客户操作"></a>潜在客户操作</h2><p>默认客户添加时为潜在客户<br>潜在客户中的操作：编辑、跟进、移交、修改状态</p>
<ul>
<li>跟进，销售为了维持用户，需要持续关注用户，可能需要2天后给用户打个电话，在跟进历史中就可以查询到。</li>
<li>移交  指把客户从一个员工交给另一个员工处理。需要 客户id，新老员工id，操作员和操作时间，原因等。其记录应当在移交历史中可查。</li>
</ul>
<h2 id="客户池"><a href="#客户池" class="headerlink" title="客户池"></a>客户池</h2><p>销售搞不定的客户会存入客户池中<br>客户池操作，吸纳，移交</p>
<ul>
<li>吸纳 将失败用户或者客户池中的客户重新回炉，本质上还是移交，</li>
<li>移交，指把客户从一个员工交给另一个员工处理。需要 客户id，新老员工id，操作员和操作时间，原因等。其记录应当在移交历史中可查。</li>
</ul>
<h1 id="报表"><a href="#报表" class="headerlink" title="报表"></a>报表</h1><hr>
<p>编写分组查询的 sql</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">		<span class="keyword">DATE_FORMAT</span>(c.input_time, <span class="string">'%Y-%m-%d'</span>), <span class="keyword">count</span>(c.id)</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">		customer c <span class="keyword">left</span> <span class="keyword">join</span> employee seller <span class="keyword">on</span> c.seller_id = seller.id</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">		c.status = <span class="number">0</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">		<span class="keyword">DATE_FORMAT</span>(c.input_time, <span class="string">'%Y-%m-%d'</span>)</span><br><span class="line">		</span><br><span class="line">+<span class="comment">---------------------------------------+-------------+</span></span><br><span class="line">| <span class="keyword">DATE_FORMAT</span>(c.input_time, <span class="string">'%Y-%m-%d'</span>) | <span class="keyword">count</span>(c.id) |</span><br><span class="line">+<span class="comment">---------------------------------------+-------------+</span></span><br><span class="line">| <span class="number">2018</span><span class="number">-07</span><span class="number">-01</span>                            |           <span class="number">1</span> |</span><br><span class="line">+<span class="comment">---------------------------------------+-------------+</span></span><br><span class="line">| <span class="number">2018</span><span class="number">-08</span><span class="number">-03</span>                            |           <span class="number">3</span> |</span><br><span class="line">+<span class="comment">---------------------------------------+-------------+</span></span><br><span class="line">| <span class="number">2018</span><span class="number">-09</span><span class="number">-28</span>                            |           <span class="number">2</span> |</span><br><span class="line">+<span class="comment">---------------------------------------+-------------+</span></span><br><span class="line">| <span class="number">2019</span><span class="number">-02</span><span class="number">-01</span>                            |           <span class="number">1</span> |</span><br><span class="line">+<span class="comment">---------------------------------------+-------------+</span></span><br></pre></td></tr></table></figure>

<p>将查询结果封装起来，方式一 使用 JavaBean 来封装， </p>
<p>二 使用 map 集合封装(比较简单，推荐)</p>
<p><code>List&lt;Map(String, Object)&gt;</code>  ——&gt; 一个 JavaBean 对象 ———-&gt; 一行数据，每个 <code>map&lt;String, Object&gt;</code> 存放其中某行，列为 key 的值。</p>
<h2 id="设计sql"><a href="#设计sql" class="headerlink" title="设计sql"></a>设计sql</h2><p>初始 sql 分组查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT DATE_FORMAT(c.input_time,'%Y-%m-%d'), COUNT(c.id) FROM customer c LEFT JOIN employee seller on c.seller_id = seller.id</span><br><span class="line">WHERE c.`status` = 0</span><br><span class="line">GROUP BY DATE_FORMAT(c.input_time,'%Y-%m-%d');</span><br><span class="line">+<span class="comment">--------------------------------------+-------------+</span></span><br><span class="line">| DATE_FORMAT(c.input_time,'%Y-%m-%d') | COUNT(c.id) |</span><br><span class="line">+<span class="comment">--------------------------------------+-------------+</span></span><br><span class="line">| 2018-07-01                           |           1 |</span><br><span class="line">| 2018-08-03                           |           3 |</span><br><span class="line">| 2018-09-28                           |           2 |</span><br><span class="line">| 2019-02-01                           |           1 |</span><br><span class="line">| 2019-09-01                           |           8 |</span><br><span class="line">| 2019-09-02                           |           1 |</span><br><span class="line">+<span class="comment">--------------------------------------+-------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>报表基本是分组查询应用，但我们需要可变的参数的分组查询。有2个基本点：</p>
<ul>
<li>GROUP BY 后面的内容应该和查询内容一致，比如，我要按日期将用户分组，则如上述查询，哪个日期下有那几个客户。再如，按销售人员分组那么 sql 就变成如下</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT seller.name, COUNT(c.id) FROM customer c LEFT JOIN employee seller on c.seller_id = seller.id</span><br><span class="line">WHERE c.`status` = 0</span><br><span class="line">GROUP BY seller.name;</span><br><span class="line">+<span class="comment">-------+-------------+</span></span><br><span class="line">| name  | COUNT(c.id) |</span><br><span class="line">+<span class="comment">-------+-------------+</span></span><br><span class="line">| admin |           1 |</span><br><span class="line">| will  |           5 |</span><br><span class="line">| 李朝  |           2 |</span><br><span class="line">| 李朝2 |           2 |</span><br><span class="line">| 李朝3 |           1 |</span><br><span class="line">| 李朝4 |           1 |</span><br><span class="line">| 李朝5 |           3 |</span><br><span class="line">| 李朝6 |           1 |</span><br><span class="line">+<span class="comment">---------+----------+</span></span><br></pre></td></tr></table></figure>

<p>所以，select 后面查询的数据，应该跟按什么分组一致，所以使用一个别名来记录分组和查询内容，sql就变成了</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="comment">#&#123;groupType&#125; groupType, COUNT(c.id) FROM customer c LEFT JOIN employee seller on c.seller_id = seller.id</span></span><br><span class="line"><span class="keyword">WHERE</span> c.<span class="string">`status`</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> groupType</span><br></pre></td></tr></table></figure>

<p>之后的高级查询，其实就是 where 语句的拼接了。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryCustomerCountByCondition"</span> <span class="attr">resultType</span>=<span class="string">"java.util.Map"</span>&gt;</span></span><br><span class="line">    SELECT $&#123;groupType&#125; groupType,</span><br><span class="line">           COUNT(c.id) number</span><br><span class="line">    FROM customer c</span><br><span class="line">             LEFT JOIN employee seller on c.seller_id = seller.id</span><br><span class="line">    WHERE c.status = #&#123;status&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"keyword != null"</span>&gt;</span></span><br><span class="line">        and (seller.name like concat('%', #&#123;keyword&#125;, '%') OR seller.email like concat('%', #&#123;keyword&#125;, '%'))</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"beginDate != null"</span>&gt;</span></span><br><span class="line">        and c.input_time &amp;gt; #&#123;beginDate&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"endDate != null"</span>&gt;</span></span><br><span class="line">        and c.input_time &amp;lt; #&#123;endDate&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    GROUP BY $&#123;groupType&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>${}</code> 和 <code>#{}</code> 因为我们需要拼接 sql 而不仅仅传值，因此 sql 的 select 后面使用 <code>${}</code>，会将字符串表达的语句直接和原 sql 拼接成一条执行</p>
<h2 id="设计查询-queryObject"><a href="#设计查询-queryObject" class="headerlink" title="设计查询 queryObject"></a>设计查询 queryObject</h2><p>以往，都是用 javaBean 封装数据库查出来的数据，由于报表不同于其他数据，报表数据通常是一个集合，而且只用一次，我们不会用数据库去存储，因此也不会单独建立一个 javabean 来封装。所以使用 map 封装。</p>
<p>由上面的 sql 可以看出，一个 <code>map&lt;String, Object&gt;</code> 对象对应一行数据，map 中每个 key 都是列名(column)，value 则是列对应的 value。而数据集合是由很多行数据组成的，所以可以将 resultType 定义为 map，最后的结果集使用 <code>List&lt;Map&gt;</code> 来封装。</p>
<p>由于报表数据类目是随机的，所以 queryObject 需要给出指定的类目数组(groupTypeDisplayValues)，不同的类目对应的 sql 是不一样的，所以还需要给出对于某个类目，能返回 sql 的属性(groupTypeValue)。而由于页面数据的回显问题，需要进行数据类目的比较，所以我认为使用常数标注类目，所以最终代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueryChart</span> <span class="keyword">extends</span> <span class="title">QueryKeyword</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> status = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> Date beginDate;</span><br><span class="line">    <span class="keyword">private</span> Date endDate;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> GROUPTYPE_EMPLOYEE = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> GROUPTYPE_YEAR = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> GROUPTYPE_MONTH = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> GROUPTYPE_DAY = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> groupType = GROUPTYPE_EMPLOYEE;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] groupTypes = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="keyword">private</span> String[] groupTypeDisplayValues = &#123;<span class="string">"员工"</span>, <span class="string">"年"</span>, <span class="string">"月"</span>, <span class="string">"日"</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getEndDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DateUtil.getEndDate(endDate);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getGroupTypeValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (groupType) &#123;</span><br><span class="line">            <span class="keyword">case</span> GROUPTYPE_EMPLOYEE: <span class="keyword">return</span> <span class="string">"seller.name"</span>;</span><br><span class="line">            <span class="keyword">case</span> GROUPTYPE_YEAR: <span class="keyword">return</span> <span class="string">"DATE_FORMAT(c.input_time,'%Y')"</span>;</span><br><span class="line">            <span class="keyword">case</span> GROUPTYPE_MONTH: <span class="keyword">return</span> <span class="string">"DATE_FORMAT(c.input_time,'%Y-%m')"</span>;</span><br><span class="line">            <span class="keyword">case</span> GROUPTYPE_DAY: <span class="keyword">return</span> <span class="string">"DATE_FORMAT(c.input_time,'%Y-%m-%d')"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>模板视图代码关键位置代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class&#x3D;&quot;form-group&quot;&gt;</span><br><span class="line">    &lt;label for&#x3D;&quot;status&quot;&gt;分组类型:&lt;&#x2F;label&gt;</span><br><span class="line">    &lt;select class&#x3D;&quot;form-control&quot; id&#x3D;&quot;groupType&quot; name&#x3D;&quot;groupType&quot;&gt;</span><br><span class="line">    &lt;#list qo.groupTypes as k&gt;</span><br><span class="line">        &lt;option value&#x3D;&quot;$&#123;k&#125;&quot;</span><br><span class="line">                &lt;#if k &#x3D;&#x3D; qo.groupType&gt;</span><br><span class="line">                    selected</span><br><span class="line">                &lt;&#x2F;#if&gt;</span><br><span class="line">        &gt;</span><br><span class="line">            $&#123;qo.groupTypeDisplayValues[k]&#125;</span><br><span class="line">        &lt;&#x2F;option&gt;</span><br><span class="line">    &lt;&#x2F;#list&gt;</span><br><span class="line">    &lt;&#x2F;select&gt;</span><br><span class="line">    &lt;button id&#x3D;&quot;btn_query&quot; class&#x3D;&quot;btn btn-primary&quot;&gt;</span><br><span class="line">        &lt;span class&#x3D;&quot;glyphicon glyphicon-search&quot;&gt;&lt;&#x2F;span&gt; 查询</span><br><span class="line">    &lt;&#x2F;button&gt;</span><br><span class="line">    &lt;button type&#x3D;&quot;button&quot; class&#x3D;&quot;btn btn-info chart_btn&quot; data-url&#x3D;&quot;&#x2F;reportForms&#x2F;customerReportForms_bar&quot;&gt;</span><br><span class="line">        &lt;span class&#x3D;&quot;glyphicon glyphicon-stats&quot;&gt;&lt;&#x2F;span&gt; 柱状图</span><br><span class="line">    &lt;&#x2F;button&gt;</span><br><span class="line">    &lt;button type&#x3D;&quot;button&quot; class&#x3D;&quot;btn btn-warning chart_btn&quot;  data-url&#x3D;&quot;&#x2F;reportForms&#x2F;customerReportForms_pie&quot;&gt;</span><br><span class="line">        &lt;span class&#x3D;&quot;glyphicon glyphicon-dashboard&quot;&gt;&lt;&#x2F;span&gt; 饼状图</span><br><span class="line">    &lt;&#x2F;button&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>

<h2 id="柱状图和饼状图"><a href="#柱状图和饼状图" class="headerlink" title="柱状图和饼状图"></a>柱状图和饼状图</h2><p>前端的图形视图采用 <a href="https://www.echartsjs.com/examples/zh/index.html" target="_blank" rel="noopener">echarts</a>中的模型插件。<br>主要的点是对数据的封装和数据结构的理解，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">option = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">var</span> dataAxis = $&#123;groupTypes&#125;;   <span class="comment">// = ['1', '2'...]</span></span><br><span class="line"><span class="keyword">var</span> data = $&#123;numbers&#125;;          <span class="comment">// = [1, 2, 3]</span></span><br><span class="line"><span class="keyword">var</span> yMax = $&#123;maxNumber&#125;;        <span class="comment">// = 500</span></span><br><span class="line"><span class="keyword">var</span> dataShadow = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.length; i++) &#123;</span><br><span class="line">    dataShadow.push(yMax);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第一个柱状视图需要的数据大致为，柱子总高度以及当前列柱高。很显然，data，应该是可比较的柱高，而 dataAxis 就是描述了。这里需要注意的是 data 需要的数据类型是个 js 数组。而如果按以往封装数据的话，是个 java 的 List 类型的数据，显然不能够直接赋值。必须转成 js 可以识别的 json 对象。所以需要如下代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/customerReportForms_bar"</span>)</span><br><span class="line"><span class="meta">@RequiresPermissions</span>(value = &#123;<span class="string">"reportForms:customerReportForms_bar"</span>, <span class="string">"客户报表柱状图"</span>&#125;, logical = Logical.OR)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">customerReportForms_bar</span><span class="params">(Model model, @ModelAttribute(<span class="string">"qo"</span>)</span> QueryChart qo) </span>&#123;</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; maps = customerChartService.getsCustomerCountByCondition(qo);</span><br><span class="line">    List&lt;Object&gt; groupTypes = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    List&lt;Object&gt; numbers = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    Long count = <span class="number">0l</span>;</span><br><span class="line">    <span class="keyword">for</span> (Map&lt;String, Object&gt; map : maps) &#123;</span><br><span class="line">        Long number = (Long) map.get(<span class="string">"number"</span>);</span><br><span class="line">        groupTypes.add(map.get(<span class="string">"groupType"</span>));</span><br><span class="line">        numbers.add(number);</span><br><span class="line">        <span class="keyword">if</span> (count &lt; number) count = number;</span><br><span class="line">    &#125;</span><br><span class="line">    model.addAttribute(<span class="string">"groupTypes"</span>, JSON.toJSONString(groupTypes));</span><br><span class="line">    model.addAttribute(<span class="string">"numbers"</span>, JSON.toJSONString(numbers));</span><br><span class="line">    model.addAttribute(<span class="string">"maxNumber"</span>, Math.ceil(count + count * <span class="number">0.3</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"reportForms/customerReportForms_bar"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/customerReportForms_pie"</span>)</span><br><span class="line"><span class="meta">@RequiresPermissions</span>(value = &#123;<span class="string">"reportForms:customerReportForms_pie"</span>, <span class="string">"客户报表柱状图"</span>&#125;, logical = Logical.OR)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">customerReportForms_pie</span><span class="params">(Model model, @ModelAttribute(<span class="string">"qo"</span>)</span> QueryChart qo) </span>&#123;</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; maps = customerChartService.getsCustomerCountByCondition(qo);</span><br><span class="line">    model.addAttribute(<span class="string">"maps"</span>, JSON.toJSONString(maps));</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"reportForms/customerReportForms_pie"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>饼状图同理。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html style&#x3D;&quot;height: 100%&quot;&gt;</span><br><span class="line">   &lt;head&gt;</span><br><span class="line">       &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">   &lt;&#x2F;head&gt;</span><br><span class="line">   &lt;body style&#x3D;&quot;height: 100%; margin: 0&quot;&gt;</span><br><span class="line">       &lt;div id&#x3D;&quot;container&quot; style&#x3D;&quot;height: 100%&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">       &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;echarts&#x2F;echarts.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">       &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;echarts&#x2F;echarts-gl.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">       &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;echarts&#x2F;ecStat.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">       &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;echarts&#x2F;dataTool.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">       &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;echarts&#x2F;china.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">       &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;echarts&#x2F;world.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">       &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;echarts&#x2F;bmap.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">       &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;js&#x2F;echarts&#x2F;simplex.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">       &lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;</span><br><span class="line">var dom &#x3D; document.getElementById(&quot;container&quot;);</span><br><span class="line">var myChart &#x3D; echarts.init(dom);</span><br><span class="line">var app &#x3D; &#123;&#125;;</span><br><span class="line">option &#x3D; null;</span><br><span class="line">var data &#x3D; genData(50);</span><br><span class="line"></span><br><span class="line">option &#x3D; &#123;</span><br><span class="line">    title : &#123;</span><br><span class="line">        text: &#39;潜在客户新增报表&#39;,</span><br><span class="line">        subtext: &#39;根据销售或时间统计&#39;,</span><br><span class="line">        x:&#39;center&#39;</span><br><span class="line">    &#125;,</span><br><span class="line">    tooltip : &#123;</span><br><span class="line">        trigger: &#39;item&#39;,</span><br><span class="line">        formatter: &quot;&#123;a&#125; &lt;br&#x2F;&gt;&#123;b&#125; : &#123;c&#125; (&#123;d&#125;%)&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    legend: &#123;</span><br><span class="line">        type: &#39;scroll&#39;,</span><br><span class="line">        orient: &#39;vertical&#39;,</span><br><span class="line">        right: 10,</span><br><span class="line">        top: 20,</span><br><span class="line">        bottom: 20,</span><br><span class="line">        data: data.legendData,</span><br><span class="line"></span><br><span class="line">        selected: data.selected</span><br><span class="line">    &#125;,</span><br><span class="line">    series : [</span><br><span class="line">        &#123;</span><br><span class="line">            name: &#39;姓名&#39;,</span><br><span class="line">            type: &#39;pie&#39;,</span><br><span class="line">            radius : &#39;55%&#39;,</span><br><span class="line">            center: [&#39;40%&#39;, &#39;50%&#39;],</span><br><span class="line">            data: data.seriesData,</span><br><span class="line">            itemStyle: &#123;</span><br><span class="line">                emphasis: &#123;</span><br><span class="line">                    shadowBlur: 10,</span><br><span class="line">                    shadowOffsetX: 0,</span><br><span class="line">                    shadowColor: &#39;rgba(0, 0, 0, 0.5)&#39;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function genData(count) &#123;</span><br><span class="line">    var seriesData &#x3D; [];</span><br><span class="line">    $&#123;maps&#125;.forEach(function (map) &#123;</span><br><span class="line">        seriesData.push(&#123;</span><br><span class="line">            name: map.groupType,</span><br><span class="line">            value: map.number</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">        seriesData: seriesData</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">if (option &amp;&amp; typeof option &#x3D;&#x3D;&#x3D; &quot;object&quot;) &#123;</span><br><span class="line">    myChart.setOption(option, true);</span><br><span class="line">&#125;</span><br><span class="line">       &lt;&#x2F;script&gt;</span><br><span class="line">   &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>


</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Ammar</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://lizhaoloveit.cn/2019/08/24/CRM%E7%B3%BB%E7%BB%9F/">http://lizhaoloveit.cn/2019/08/24/CRM%E7%B3%BB%E7%BB%9F/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://lizhaoloveit.cn">Ammar's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java    </a></div><div class="post_share"><div class="social-share" data-image="https://lizhaoloveit.cn/blogimages/blog/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-buttom"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lozad post-qr-code__img" data-src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lozad post-qr-code__img" data-src="/img/alipay.jpg"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull-left"><a href="/2019/08/25/Shiro%E6%9D%83%E9%99%90%E6%A1%86%E6%9E%B6/"><img class="prev_cover lozad" data-src="https://www.lizhaoloveit.cn/blogimages/blog/cover/1.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/2.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/3.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/4.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/5.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/6.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/7.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/8.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/9.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/10.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/11.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/12.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/13.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/14.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/15.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/16.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/17.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/18.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/19.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/20.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/21.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/22.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/23.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/24.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/25.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/26.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/27.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/28.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/29.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/31.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/32.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/33.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/34.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/35.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/36.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/37.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/38.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/39.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/40.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/41.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/42.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/43.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/44.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/45.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/46.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/47.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/48.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/49.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/50.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/51.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/52.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/53.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/54.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/55.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/56.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/57.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/58.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/59.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/60.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/62.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/63.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/64.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/65.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/66.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/67.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/68.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/69.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/70.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/71.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/72.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/73.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/74.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/75.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/76.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/77.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/78.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/79.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>Shiro权限框架</span></div></a></div><div class="next-post pull-right"><a href="/2019/08/23/IDEA%E5%AE%89%E8%A3%85JRebel%E6%8F%92%E4%BB%B6%E5%AE%9E%E7%8E%B0%E7%83%AD%E6%9B%B4%E6%96%B0/"><img class="next_cover lozad" data-src="https://www.lizhaoloveit.cn/blogimages/blog/cover/1.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/2.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/3.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/4.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/5.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/6.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/7.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/8.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/9.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/10.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/11.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/12.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/13.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/14.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/15.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/16.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/17.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/18.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/19.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/20.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/21.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/22.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/23.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/24.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/25.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/26.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/27.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/28.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/29.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/31.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/32.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/33.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/34.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/35.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/36.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/37.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/38.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/39.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/40.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/41.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/42.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/43.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/44.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/45.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/46.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/47.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/48.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/49.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/50.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/51.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/52.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/53.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/54.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/55.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/56.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/57.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/58.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/59.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/60.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/62.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/63.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/64.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/65.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/66.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/67.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/68.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/69.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/70.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/71.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/72.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/73.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/74.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/75.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/76.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/77.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/78.jpg,https://www.lizhaoloveit.cn/blogimages/blog/cover/79.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>IDEA安装JRebel插件实现热更新(21-9-25)</span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div id="disqus_thread"></div><script>var unused = null;
var disqus_config = function () {
  this.page.url = 'http://lizhaoloveit.cn/2019/08/24/CRM%E7%B3%BB%E7%BB%9F/';
  this.page.identifier = '2019/08/24/CRM系统/';
  this.page.title = 'CRM系统';
}
var d = document, s = d.createElement('script');
s.src = "https://" + 'lizhao' +".disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script></div></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2014 - 2024 By Ammar</div><div class="icp"><a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener"><span>浙ICP备19013619号-1</span></a></div><div class="bag"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33010502006128" target="_blank" rel="noopener"><img src="/img/beian.png"><span>浙公网安备 33010502006128号</span></a></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><section class="rightside" id="rightside"><i class="fa fa-book" id="readmode" title="阅读模式"> </i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换">繁</a><i class="far fa-moon nightshift" id="nightshift" title="夜间模式"></i></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script async src="/js/search/algolia.js"></script><script src="/js/nightshift.js"></script><script src="/js/tw_cn.js"></script><script>translateInitilization()

</script><script src="https://cdn.jsdelivr.net/npm/instant.page@1.2.2/instantpage.min.js" type="module"></script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><!-- hexo-inject:begin --><!-- hexo-inject:end --></body></html>